{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"factoryName": {
			"type": "string",
			"metadata": "Data Factory name",
			"defaultValue": "CAMRIN-CAMDASH-ADF-01"
		},
		"ActDem_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'ActDem'"
		},
		"CAMDASH_DATALAKE_accountKey": {
			"type": "secureString",
			"metadata": "Secure string for 'accountKey' of 'CAMDASH_DATALAKE'"
		},
		"RADFYF01_CRIS_PostgreSQL_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'RADFYF01_CRIS_PostgreSQL'",
			"defaultValue": "Integrated Security=True;Data Source=LHCH-RADFYF01;Initial Catalog=_CRIS_PostgreSQL"
		},
		"RADFYF01_CRIS_PostgreSQL_password": {
			"type": "secureString",
			"metadata": "Secure string for 'password' of 'RADFYF01_CRIS_PostgreSQL'"
		},
		"camdashdevtest101_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'camdashdevtest101'",
			"defaultValue": "Integrated Security=False;Encrypt=True;Connection Timeout=30;Data Source=camrinsql101.database.windows.net;Initial Catalog=camdashdevtest101"
		},
		"camdashprod101_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'camdashprod101'",
			"defaultValue": "Integrated Security=False;Encrypt=True;Connection Timeout=30;Data Source=camrinsql101.database.windows.net;Initial Catalog=camdashprod101"
		},
		"sql_nw_dme_01_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'sql_nw_dme_01'",
			"defaultValue": "Integrated Security=False;Encrypt=True;Connection Timeout=30;Data Source=sql-uks-dme-01.database.windows.net;Initial Catalog=sql-nw-dme-01"
		},
		"CAMDASH_DATALAKE_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://camdashdatalake.dfs.core.windows.net/"
		},
		"RADFYF01_CRIS_PostgreSQL_properties_typeProperties_userName": {
			"type": "string",
			"defaultValue": "Ctc\\radfyf.sql"
		},
		"Test_AzureBlobStorage_properties_typeProperties_serviceEndpoint": {
			"type": "string",
			"defaultValue": "https://camdashdatalake.blob.core.windows.net/"
		},
		"camdashprod101_mpep_properties_privateLinkResourceId": {
			"type": "string",
			"defaultValue": "/subscriptions/7f24a222-ee8f-45d1-9d9e-71193702a08a/resourceGroups/CAMRIN-CAMDASH-UKS-SQL-RG/providers/Microsoft.Sql/servers/camrinsql101"
		},
		"camdashprod101_mpep_properties_groupId": {
			"type": "string",
			"defaultValue": "sqlServer"
		},
		"camdashprod101_mpep_properties_fqdns": {
			"type": "array",
			"defaultValue": [
				"camrinsql101.database.windows.net"
			]
		}
	},
	"variables": {
		"factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('factoryName'), '/AutoResolveAzureIR')]",
			"type": "Microsoft.DataFactory/factories/integrationRuntimes",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "Managed",
				"typeProperties": {
					"computeProperties": {
						"location": "AutoResolve",
						"dataFlowProperties": {
							"computeType": "General",
							"coreCount": 8,
							"timeToLive": 10,
							"cleanup": false
						}
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/LHCH-IR')]",
			"type": "Microsoft.DataFactory/factories/integrationRuntimes",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "SelfHosted",
				"description": "SHIR at LHCH for initial config",
				"typeProperties": {}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/default')]",
			"type": "Microsoft.DataFactory/factories/managedVirtualNetworks",
			"apiVersion": "2018-06-01",
			"properties": {},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ActDem')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureTableStorage",
				"typeProperties": {
					"connectionString": "[parameters('ActDem_connectionString')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveAzureIR",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/integrationRuntimes/AutoResolveAzureIR')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/CAMDASH_DATALAKE')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureBlobFS",
				"typeProperties": {
					"url": "[parameters('CAMDASH_DATALAKE_properties_typeProperties_url')]",
					"accountKey": {
						"type": "SecureString",
						"value": "[parameters('CAMDASH_DATALAKE_accountKey')]"
					}
				},
				"connectVia": {
					"referenceName": "AutoResolveAzureIR",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/integrationRuntimes/AutoResolveAzureIR')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/RADFYF01_CRIS_PostgreSQL')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "SqlServer",
				"typeProperties": {
					"connectionString": "[parameters('RADFYF01_CRIS_PostgreSQL_connectionString')]",
					"userName": "[parameters('RADFYF01_CRIS_PostgreSQL_properties_typeProperties_userName')]",
					"password": {
						"type": "SecureString",
						"value": "[parameters('RADFYF01_CRIS_PostgreSQL_password')]"
					}
				},
				"connectVia": {
					"referenceName": "LHCH-IR",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/integrationRuntimes/LHCH-IR')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Test_AzureBlobStorage')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureBlobStorage",
				"typeProperties": {
					"serviceEndpoint": "[parameters('Test_AzureBlobStorage_properties_typeProperties_serviceEndpoint')]",
					"accountKind": "StorageV2"
				},
				"connectVia": {
					"referenceName": "AutoResolveAzureIR",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/integrationRuntimes/AutoResolveAzureIR')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/camdashdevtest101')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureSqlDatabase",
				"typeProperties": {
					"connectionString": "[parameters('camdashdevtest101_connectionString')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveAzureIR",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/integrationRuntimes/AutoResolveAzureIR')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/camdashprod101')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureSqlDatabase",
				"typeProperties": {
					"connectionString": "[parameters('camdashprod101_connectionString')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveAzureIR",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/integrationRuntimes/AutoResolveAzureIR')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/sql_nw_dme_01')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureSqlDatabase",
				"typeProperties": {
					"connectionString": "[parameters('sql_nw_dme_01_connectionString')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveAzureIR",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/integrationRuntimes/AutoResolveAzureIR')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/AutoResolveIntegrationRuntime')]",
			"type": "Microsoft.DataFactory/factories/integrationRuntimes",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "Managed",
				"typeProperties": {
					"computeProperties": {
						"location": "AutoResolve",
						"dataFlowProperties": {
							"computeType": "General",
							"coreCount": 8,
							"timeToLive": 0,
							"cleanup": true
						},
						"pipelineExternalComputeScaleProperties": {
							"timeToLive": 60
						}
					}
				},
				"managedVirtualNetwork": {
					"type": "ManagedVirtualNetworkReference",
					"referenceName": "default"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/managedVirtualNetworks/default')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/default/camdashprod101_mpep')]",
			"type": "Microsoft.DataFactory/factories/managedVirtualNetworks/managedPrivateEndpoints",
			"apiVersion": "2018-06-01",
			"properties": {
				"privateLinkResourceId": "[parameters('camdashprod101_mpep_properties_privateLinkResourceId')]",
				"groupId": "[parameters('camdashprod101_mpep_properties_groupId')]",
				"fqdns": "[parameters('camdashprod101_mpep_properties_fqdns')]"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/managedVirtualNetworks/default')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/AIDFCC')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "camdashdevtest101",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "dev",
					"table": "AIDFCC"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/camdashdevtest101')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/AIDFXC')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "camdashdevtest101",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "dev",
					"table": "AIDFXC"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/camdashdevtest101')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/APDNA')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "RADFYF01_CRIS_PostgreSQL",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "SqlServerTable",
				"schema": [
					{
						"name": "Event Key",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Accession",
						"type": "varchar"
					},
					{
						"name": "Event Date",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "Booked Date",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "Referring Locat",
						"type": "varchar"
					},
					{
						"name": "Examination",
						"type": "varchar"
					},
					{
						"name": "Room",
						"type": "varchar"
					},
					{
						"name": "Status Code",
						"type": "varchar"
					},
					{
						"name": "Lead Clincian ",
						"type": "varchar"
					},
					{
						"name": "Examination Name",
						"type": "varchar"
					},
					{
						"name": "Stat Date",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "FYF_ODBC_APDNA"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/RADFYF01_CRIS_PostgreSQL')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Act_Dem')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "camdashdevtest101",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "Activity",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Date",
						"type": "date"
					},
					{
						"name": "Demand",
						"type": "money",
						"precision": 19,
						"scale": 4
					},
					{
						"name": "ID",
						"type": "nvarchar"
					},
					{
						"name": "Modality ID",
						"type": "nvarchar"
					},
					{
						"name": "Month",
						"type": "nvarchar"
					},
					{
						"name": "Monthly Activity Sum",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Monthly Demand Sum",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Monthly Max",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Trust ID",
						"type": "nvarchar"
					},
					{
						"name": "Years",
						"type": "nvarchar"
					},
					{
						"name": "DNA",
						"type": "nvarchar"
					},
					{
						"name": "DNARate",
						"type": "nvarchar"
					}
				],
				"typeProperties": {
					"schema": "dev",
					"table": "Act_Dem"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/camdashdevtest101')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ActivityHDRep_wnj_ControlDS')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "camdashdevtest101",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "ActivityHDRep_wnj_20230427"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"table": "MainControlTable_wnj"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/camdashdevtest101')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ActivityHDRep_wnj_DestinationDS')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "camdashdevtest101",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"cw_schema": {
						"type": "String"
					},
					"cw_table": {
						"type": "String"
					}
				},
				"folder": {
					"name": "ActivityHDRep_wnj_20230427"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": {
						"value": "@dataset().cw_schema",
						"type": "Expression"
					},
					"table": {
						"value": "@dataset().cw_table",
						"type": "Expression"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/camdashdevtest101')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ActivityHDRep_wnj_SourceDS')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Test_AzureBlobStorage",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"cw_sheetName": {
						"type": "String"
					},
					"cw_firstRowAsHeader": {
						"type": "Bool"
					},
					"cw_fileName": {
						"type": "String"
					},
					"cw_folderPath": {
						"type": "Object"
					},
					"cw_container": {
						"type": "String"
					}
				},
				"folder": {
					"name": "ActivityHDRep_wnj_20230427"
				},
				"annotations": [],
				"type": "Excel",
				"typeProperties": {
					"sheetName": {
						"value": "@dataset().cw_sheetName",
						"type": "Expression"
					},
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": {
							"value": "@dataset().cw_fileName",
							"type": "Expression"
						},
						"folderPath": {
							"value": "@dataset().cw_folderPath",
							"type": "Expression"
						},
						"container": {
							"value": "@dataset().cw_container",
							"type": "Expression"
						}
					},
					"firstRowAsHeader": {
						"value": "@dataset().cw_firstRowAsHeader",
						"type": "Expression"
					}
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/Test_AzureBlobStorage')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/AzureSQLCoreV3Staging')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "camdashdevtest101",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "CRIS No",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Accession",
						"type": "nvarchar"
					},
					{
						"name": "Ref Src",
						"type": "nvarchar"
					},
					{
						"name": "Site",
						"type": "nvarchar"
					},
					{
						"name": "Request Date",
						"type": "date"
					},
					{
						"name": "Event Date",
						"type": "date"
					},
					{
						"name": "Event Time",
						"type": "nvarchar"
					},
					{
						"name": "On Call",
						"type": "nvarchar"
					},
					{
						"name": "PT",
						"type": "nvarchar"
					},
					{
						"name": "Examination",
						"type": "nvarchar"
					},
					{
						"name": "Exam Name",
						"type": "nvarchar"
					},
					{
						"name": "Room",
						"type": "nvarchar"
					},
					{
						"name": "ExamSite Code",
						"type": "nvarchar"
					},
					{
						"name": "Start Time",
						"type": "nvarchar"
					},
					{
						"name": "End Time",
						"type": "nvarchar"
					},
					{
						"name": "Exam Key",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Event Key",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Status Code",
						"type": "nvarchar"
					},
					{
						"name": "Booked Date",
						"type": "datetime2",
						"scale": 7
					},
					{
						"name": "Booked Time",
						"type": "nvarchar"
					},
					{
						"name": "Creation Date",
						"type": "datetime2",
						"scale": 7
					},
					{
						"name": "Attended",
						"type": "nvarchar"
					},
					{
						"name": "Urg",
						"type": "nvarchar"
					},
					{
						"name": "Modality",
						"type": "nvarchar"
					},
					{
						"name": "No of Proc",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Planned Appointment Date",
						"type": "datetime2",
						"scale": 7
					},
					{
						"name": "Date First Verified",
						"type": "datetime2",
						"scale": 7
					},
					{
						"name": "Time First Verified",
						"type": "nvarchar"
					},
					{
						"name": "Was Planned",
						"type": "nvarchar"
					},
					{
						"name": "Was Scheduled",
						"type": "nvarchar"
					},
					{
						"name": "Was Waiting",
						"type": "nvarchar"
					},
					{
						"name": "Stat Date",
						"type": "datetime2",
						"scale": 7
					},
					{
						"name": "Modality2",
						"type": "nvarchar"
					},
					{
						"name": "Trust Name",
						"type": "nvarchar"
					},
					{
						"name": "Patient_Type",
						"type": "nvarchar"
					},
					{
						"name": "Tat Type",
						"type": "nvarchar"
					},
					{
						"name": "Status Time",
						"type": "nvarchar"
					},
					{
						"name": "Reported By",
						"type": "nvarchar"
					},
					{
						"name": "Rank",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Age At Event",
						"type": "int",
						"precision": 10
					}
				],
				"typeProperties": {
					"schema": "dev",
					"table": "AzureSQL_CoreV3Staging"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/camdashdevtest101')]"
			]
		}
	]
}