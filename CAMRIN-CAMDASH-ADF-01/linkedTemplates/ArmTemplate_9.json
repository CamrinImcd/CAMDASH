{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"factoryName": {
			"type": "string",
			"metadata": "Data Factory name",
			"defaultValue": "CAMRIN-CAMDASH-ADF-01"
		}
	},
	"variables": {
		"factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('factoryName'), '/Move from ICB to CAMRIN')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Move to DEV_TEST",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table [Unify].[NAT_DM01]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "CM_Sql_Unify_NAT_DM01",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "CAMRIN_Unify_DM01",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Move to PROD",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Move to DEV_TEST",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table [Unify].[NAT_DM01]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "CM_Sql_Unify_NAT_DM01",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "PROD_Unity_DM01",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "Unify"
				},
				"annotations": [],
				"lastPublishTime": "2023-11-23T11:22:55Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/CreateActDem')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "FYF_ODBC_CORE_v2",
								"type": "DatasetReference"
							},
							"name": "Core"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "Act_Dem",
								"type": "DatasetReference"
							},
							"name": "sink1"
						}
					],
					"transformations": [
						{
							"name": "CreateDNAColumn"
						},
						{
							"name": "GroupbyEvent"
						},
						{
							"name": "GroupbyRequest"
						},
						{
							"name": "RenameDate1"
						},
						{
							"name": "RenameDate2"
						},
						{
							"name": "derivedColumn1"
						},
						{
							"name": "derivedColumn2"
						},
						{
							"name": "join1"
						},
						{
							"name": "derivedColumn3"
						},
						{
							"name": "select1"
						},
						{
							"name": "derivedColumn4"
						},
						{
							"name": "aggregate1"
						},
						{
							"name": "aggregate2"
						},
						{
							"name": "join2"
						},
						{
							"name": "join3"
						},
						{
							"name": "select2"
						},
						{
							"name": "select3"
						},
						{
							"name": "derivedColumn5"
						},
						{
							"name": "filter1"
						},
						{
							"name": "filter2"
						},
						{
							"name": "MapDrifted1",
							"description": "Creates an explicit mapping for each drifted column"
						}
					],
					"scriptLines": [
						"source(output(",
						"          {CRIS No} as integer,",
						"          Accession as string,",
						"          {Ref Src} as string,",
						"          Site as string,",
						"          {Request Date} as date,",
						"          {Event Date} as date,",
						"          {Event Time} as string,",
						"          {On Call} as string,",
						"          PT as string,",
						"          Examination as string,",
						"          {Exam Name} as string,",
						"          Room as string,",
						"          {ExamSite Code} as string,",
						"          {Start Time} as string,",
						"          {End Time} as string,",
						"          {Exam Key} as integer,",
						"          {Event Key} as integer,",
						"          {Status Code} as string,",
						"          {Booked Date} as timestamp,",
						"          {Booked Time} as string,",
						"          {Creation Date} as timestamp,",
						"          Attended as string,",
						"          Urg as string,",
						"          Modality as string,",
						"          {No of Proc} as integer,",
						"          {Planned Appointment Date} as timestamp,",
						"          {Date First Verified} as timestamp,",
						"          {Time First Verified} as string,",
						"          {Was Planned} as string,",
						"          {Was Scheduled} as string,",
						"          {Was Waiting} as string,",
						"          {Status Time} as string,",
						"          Modality2 as string,",
						"          {Trust Name} as string,",
						"          Patient_Type as string,",
						"          {Tat Type} as string,",
						"          {Status Time2} as string,",
						"          {Patient Type ID} as long,",
						"          {Modality ID} as integer,",
						"          {Status ID} as integer,",
						"          {Exam ID} as integer,",
						"          {Exam Room ID} as integer,",
						"          {Trust ID} as integer,",
						"          {Referral Source ID} as integer,",
						"          {Tat Type ID} as integer,",
						"          {Reported By} as string,",
						"          Rank as integer,",
						"          {Status Date} as timestamp,",
						"          Activity as integer,",
						"          {Count of Activty_Demand for Activity} as long,",
						"          {Stat Date} as timestamp,",
						"          {Age At Event} as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> Core",
						"MapDrifted1 derive(DNA = iif({Status Code}==\"CPDNA\", 1, iif({Status Code}==\"APDNA\", 1, 0))) ~> CreateDNAColumn",
						"CreateDNAColumn aggregate(groupBy({Event Date},",
						"          {Modality ID},",
						"          {Trust ID}),",
						"     Activity = sum(Activity),",
						"          DNA = sum(DNA)) ~> GroupbyEvent",
						"CreateDNAColumn aggregate(groupBy({Request Date},",
						"          {Modality ID},",
						"          {Trust ID}),",
						"     Demand = count(Activity)) ~> GroupbyRequest",
						"GroupbyRequest select(mapColumn(",
						"          Date = {Request Date},",
						"          {Modality ID},",
						"          {Trust ID},",
						"          Demand",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> RenameDate1",
						"GroupbyEvent select(mapColumn(",
						"          Date = {Event Date},",
						"          {Modality ID},",
						"          {Trust ID},",
						"          Activity,",
						"          DNA",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> RenameDate2",
						"RenameDate1 derive(Date = toDate(toString(Date)),",
						"          ID = concat(left(toString(Date),10), concat(toString({Modality ID}), toString({Trust ID})))) ~> derivedColumn1",
						"RenameDate2 derive(Date = toDate(toString(Date)),",
						"          ID = concat(left(toString(Date),10), concat(toString({Modality ID}), toString({Trust ID})))) ~> derivedColumn2",
						"filter2, derivedColumn2 join(derivedColumn1@ID == derivedColumn2@ID,",
						"     joinType:'outer',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> join1",
						"join1 derive(Date = iifNull(derivedColumn1@Date,derivedColumn2@Date),",
						"          {Modality ID} = iifNull(RenameDate1@{Modality ID},RenameDate2@{Modality ID}),",
						"          {Trust ID} = iifNull(RenameDate1@{Trust ID},RenameDate2@{Trust ID}),",
						"          ID = iifNull(derivedColumn1@ID, derivedColumn2@ID)) ~> derivedColumn3",
						"derivedColumn4 select(mapColumn(",
						"          Date,",
						"          {Modality ID},",
						"          {Trust ID},",
						"          Demand,",
						"          ID,",
						"          Activity,",
						"          DNA,",
						"          Month",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> select1",
						"derivedColumn3 derive(Month = addMonths(addDays(lastDayOfMonth(Date),1),-1)) ~> derivedColumn4",
						"derivedColumn4 aggregate(groupBy({Modality ID},",
						"          {Trust ID},",
						"          Month),",
						"     {Monthly Activity Sum} = sum(Activity),",
						"          {Monthly Demand Sum} = sum(Demand)) ~> aggregate1",
						"aggregate1 aggregate(groupBy({Modality ID},",
						"          {Trust ID},",
						"          Month),",
						"     {Monthly Demand Max} = iif(max({Monthly Demand Sum})>max({Monthly Activity Sum}), max({Monthly Demand Sum}), max({Monthly Activity Sum}))) ~> aggregate2",
						"aggregate2, aggregate1 join(aggregate2@{Modality ID} == aggregate1@{Modality ID}",
						"     && aggregate2@{Trust ID} == aggregate1@{Trust ID}",
						"     && aggregate2@Month == aggregate1@Month,",
						"     joinType:'outer',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> join2",
						"select1, select2 join(select1@{Modality ID} == select2@{Modality ID}",
						"     && select1@{Trust ID} == select2@{Trust ID}",
						"     && select1@Month == select2@Month,",
						"     joinType:'outer',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'auto')~> join3",
						"join2 select(mapColumn(",
						"          {Modality ID} = aggregate2@{Modality ID},",
						"          {Trust ID} = aggregate2@{Trust ID},",
						"          Month = aggregate2@Month,",
						"          {Monthly Demand Max},",
						"          {Monthly Activity Sum},",
						"          {Monthly Demand Sum}",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> select2",
						"join3 select(mapColumn(",
						"          Date,",
						"          {Modality ID} = select1@{Modality ID},",
						"          {Trust ID} = select1@{Trust ID},",
						"          Demand,",
						"          ID,",
						"          Activity,",
						"          DNA,",
						"          Month = select1@Month,",
						"          {Monthly Demand Max},",
						"          {Monthly Activity Sum},",
						"          {Monthly Demand Sum}",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> select3",
						"select3 derive(Year = year(Date),",
						"          DNARate = DNA/(Activity+DNA)) ~> derivedColumn5",
						"derivedColumn5 filter(isNull(ID)==false()) ~> filter1",
						"derivedColumn1 filter(isNull(ID)==false()) ~> filter2",
						"Core derive({CRIS No} = toInteger(byName('CRIS No')),",
						"          Accession = toString(byName('Accession')),",
						"          {Ref Src} = toString(byName('Ref Src')),",
						"          Site = toString(byName('Site')),",
						"          {Request Date} = toDate(byName('Request Date')),",
						"          {Event Date} = toDate(byName('Event Date')),",
						"          {Event Time} = toString(byName('Event Time')),",
						"          {On Call} = toString(byName('On Call')),",
						"          PT = toString(byName('PT')),",
						"          Examination = toString(byName('Examination')),",
						"          {Exam Name} = toString(byName('Exam Name')),",
						"          Room = toString(byName('Room')),",
						"          {ExamSite Code} = toString(byName('ExamSite Code')),",
						"          {Start Time} = toString(byName('Start Time')),",
						"          {End Time} = toString(byName('End Time')),",
						"          {Exam Key} = toInteger(byName('Exam Key')),",
						"          {Event Key} = toInteger(byName('Event Key')),",
						"          {Status Code} = toString(byName('Status Code')),",
						"          {Booked Date} = toTimestamp(byName('Booked Date')),",
						"          {Booked Time} = toString(byName('Booked Time')),",
						"          {Creation Date} = toTimestamp(byName('Creation Date')),",
						"          Attended = toString(byName('Attended')),",
						"          Urg = toString(byName('Urg')),",
						"          Modality = toString(byName('Modality')),",
						"          {No of Proc} = toInteger(byName('No of Proc')),",
						"          {Planned Appointment Date} = toTimestamp(byName('Planned Appointment Date')),",
						"          {Date First Verified} = toTimestamp(byName('Date First Verified')),",
						"          {Time First Verified} = toString(byName('Time First Verified')),",
						"          {Was Planned} = toString(byName('Was Planned')),",
						"          {Was Scheduled} = toString(byName('Was Scheduled')),",
						"          {Was Waiting} = toString(byName('Was Waiting')),",
						"          {Stat Date} = toTimestamp(byName('Stat Date')),",
						"          {Status Date} = toTimestamp(byName('Status Date')),",
						"          Modality2 = toString(byName('Modality2')),",
						"          {Trust Name} = toString(byName('Trust Name')),",
						"          Patient_Type = toString(byName('Patient_Type')),",
						"          {Tat Type} = toString(byName('Tat Type')),",
						"          Activity = toInteger(byName('Activity')),",
						"          {Count of Activty_Demand for Activity} = toLong(byName('Count of Activty_Demand for Activity')),",
						"          {Status Time2} = toString(byName('Status Time2')),",
						"          {Patient Type ID} = toLong(byName('Patient Type ID')),",
						"          {Modality ID} = toInteger(byName('Modality ID')),",
						"          {Status ID} = toInteger(byName('Status ID')),",
						"          {Exam ID} = toInteger(byName('Exam ID')),",
						"          {Exam Room ID} = toInteger(byName('Exam Room ID')),",
						"          {Trust ID} = toInteger(byName('Trust ID')),",
						"          {Referral Source ID} = toInteger(byName('Referral Source ID')),",
						"          {Tat Type ID} = toInteger(byName('Tat Type ID')),",
						"          {Reported By} = toString(byName('Reported By')),",
						"          Rank = toInteger(byName('Rank'))) ~> MapDrifted1",
						"filter1 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          Activity as integer,",
						"          Date as date,",
						"          Demand as decimal(19,4),",
						"          ID as string,",
						"          {Modality ID} as string,",
						"          Month as string,",
						"          {Monthly Activity Sum} as integer,",
						"          {Monthly Demand Sum} as integer,",
						"          {Monthly Max} as integer,",
						"          {Trust ID} as string,",
						"          Years as string,",
						"          DNA as string,",
						"          DNARate as string",
						"     ),",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     truncate:true,",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError',",
						"     mapColumn(",
						"          Activity,",
						"          Date,",
						"          Demand,",
						"          ID,",
						"          {Modality ID},",
						"          Month,",
						"          {Monthly Activity Sum},",
						"          {Monthly Demand Sum},",
						"          {Monthly Max} = {Monthly Demand Max},",
						"          {Trust ID},",
						"          Years = Year,",
						"          DNA,",
						"          DNARate",
						"     )) ~> sink1"
					]
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PopulateNewColumns')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "WranglingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"name": "RequestRecievedStatus",
							"script": "source(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table') ~> RequestRecievedStatus",
							"dataset": {
								"referenceName": "RequestRecievedStatus",
								"type": "DatasetReference"
							}
						},
						{
							"name": "AzureSqlCOREStageStep1",
							"script": "source(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table') ~> AzureSqlCOREStageStep1",
							"dataset": {
								"referenceName": "AzureSqlCOREStageStep1",
								"type": "DatasetReference"
							}
						}
					],
					"script": "section Section1;\r\nshared RequestRecievedStatus = let AdfDoc = Sql.Database(\"camrinsql101.database.windows.net\", \"camdashdevtest101\", [CreateNavigationProperties = false]), InputTable = AdfDoc{[Schema=\"dev\",Item=\"RequestRecievedStatus\"]}[Data] in InputTable;\r\nshared AzureSqlCOREStageStep1 = let AdfDoc = Sql.Database(\"camrinsql101.database.windows.net\", \"camdashdevtest101\", [CreateNavigationProperties = false]), InputTable = AdfDoc{[Schema=\"dev\",Item=\"AzureSqlCOREStageStep1\"]}[Data] in InputTable;\r\nshared UserQuery = let Source = #\"AzureSqlCOREStageStep1\",\r\n  #\"Removed columns\" = Table.RemoveColumns(Source, {\"ExamSite Code\", \"Status Time\", \"Modality2\", \"Trust Name\", \"Patient_Type\", \"Tat Type\"}),\r\n  #\"Merged queries\" = Table.NestedJoin(#\"Removed columns\", {\"Exam Key\"}, Table.SelectRows(RequestRecievedStatus, each [Status Code] = \"RR\"), {\"Exam Key\"}, \"RequestRecievedStatus\", JoinKind.LeftOuter),\r\n  #\"Expanded RequestRecievedStatus 1\" = Table.ExpandTableColumn(#\"Merged queries\", \"RequestRecievedStatus\", {\"Status Code\", \"Status Date\", \"Status Time\"}, {\"Status Code.2\", \"Status Date.1\", \"Status Time\"}),\r\n  #\"Date Time Change\" = Table.TransformColumnTypes(#\"Expanded RequestRecievedStatus 1\", {{\"Request Date\", type date}, {\"Event Date\", type date}, {\"Status Time\", type text}}),\r\n  Modality = Table.TransformColumnTypes(Table.AddColumn(#\"Date Time Change\", \"Modality2\", each if [Modality] = \"R\" then \"Plain X-Ray\" else if [Modality] = \"A\" then \"IR\" else if [Modality] = \"B\" then \"Mammo\" else if [Modality] = \"C\" then \"CT\" else if[Modality] = \"M\" then \"MRI\" else if [Modality] = \"F\" then \"Fluoro\" else if [Modality] = \"U\" then \"NOUS\"  else if [Modality] = \"N\" then \"Nuc Med\" else if[Modality] = \"S\" then \"DEXA\" else if[Modality] = \"Z\" then \"Additional Workload\" else if[Modality] = \"H\" then \"Cardio\" else if[Modality] = \"D\" then \"Doppler\" else if[Modality] = \"E\" then \"Endo\" else if[Modality] = \"Y\" then \"Med Phys\" else if[Modality] = \"O\" then \"Obstetrics\" else \"other\"), {{\"Modality2\", type text}}),\r\n  Trust = Table.TransformColumnTypes(Table.AddColumn(Modality, \"Trust Name\", each if [Site] = \"5HA16\" then \"LUHFT\" else if [Site] = \"5NL93\" then \"LUHFT\" else if Text.Start([Site],3) = \"REM\" then \"LUHFT\" else if Text.Start([Site],3) = \"RQ6\" then \"LUHFT\" else if Text.Start([Site],3) = \"RBL\" then \"WUTH\" else if Text.Start([Site],3) = \"RBN\" then \"STHK\" else if Text.Start([Site],3) = \"RBQ\" then \"LHCH\" else if Text.Start([Site],3) = \"RBS\" then \"Alder Hey\" else if Text.Start([Site],3) = \"RBT\" then \"MCH\" else if Text.Start([Site],3) = \"REN\" then \"CCC\" else if Text.Start([Site],3) = \"REP\" then \"Womens\" else if Text.Start([Site],3) = \"RET\" then \"TWC\" else if Text.Start([Site],3) = \"RJR\" then \"COCH\" else if Text.Start([Site],3) = \"RVY\" then \"S&O\" else if Text.Start([Site],3) = \"RWW\" then \"WHH\" else [Site]), {{\"Trust Name\", type text}}),\r\n  #\"Patient Type\" = Table.TransformColumnTypes(Table.AddColumn(Trust, \"Patient_Type\", each if [PT] = \"A\" then \"In Patient\" else if [PT] = \"B\" then \"Out Patient\" else if [PT] = \"C\" then \"A&E Attender\" else if [PT] = \"D\" then \"Out Patient\" else if [PT] = \"E\" then \"Out Patient\" else if [PT] = \"F\" then \"Other\" else if [PT] = \"G\" then \"GP Direct Access Patient\"  else if [PT] = \"H\" then \"In Patient\" else if[PT] = \"J\" then \"A&E Attender\" else if[PT] = \"K\" then \"Tertiary Referral\" else if[PT] = \"N\" then \"In Patient\" else if[PT] = \"R\" then \"Research\" else if[PT] = \"T\" then \"Dental\" else if[Modality] = \"X\" then \"Other\" else \"Other\"), {{\"Patient_Type\", type text}}),\r\n  #\"Tat Type\" = Table.TransformColumnTypes(Table.AddColumn(#\"Patient Type\", \"Tat Type\", each if ([Modality2]=\"CT\" or [Modality2]=\"MRI\" or [Modality2]=\"Fluoro\" or [Modality2]=\"Nuc Med\" or [Modality2]=\"Dexa\") and (([PT]=\"A\" and [Urg]=\"5\") or [PT]=\"C\") then \"Urgent Inpatients\" else \r\n\r\nif ([Modality2]=\"CT\" or [Modality2]=\"MRI\" or [Modality2]=\"Fluoro\" or [Modality2]=\"Nuc Med\" or [Modality2]=\"Dexa\") and ([PT]=\"A\" and ([Urg]=\"1\" or [Urg]=\"3\")) then \"Non-Urgent Inpatients\" else  \r\n\r\nif ([Modality2]=\"CT\" or [Modality2]=\"MRI\" or [Modality2]=\"Plain X-Ray\" or [Modality2]=\"Fluoro\" or [Modality2]=\"Nuc Med\" or [Modality2]=\"Dexa\") and ([PT]=\"B\" or [PT]=\"G\") and [Urg]=\"7\" then \"Outpatient Faster Diagnosis Standard Cancer Pathway\" else \r\n\r\nif ([Modality2]=\"CT\" or [Modality2]=\"MRI\" or [Modality2]=\"Fluoro\" or [Modality2]=\"Nuc Med\" or [Modality2]=\"Dexa\") and ([PT]=\"B\" or [PT]=\"G\" or [PT]=\"D\") and ([Urg]=\"3\" or [Urg]=\"5\") then \"Urgent GP and Outpatients\" else \r\n\r\nif ([Modality2]=\"CT\" or [Modality2]=\"MRI\") and ([PT]=\"B\" or [PT]=\"G\" or [PT]=\"D\") and [Urg]=\"1\" then \"All Other Routine Outpatient and GP Studies\" else \r\n\r\nif [Modality2]=\"Plain X-Ray\" and ([PT]=\"A\" and ([Urg]=\"1\" or [Urg]=\"3\")) then \"Other Inpatients\" else \r\n\r\nif [Modality2]=\"Plain X-Ray\" and (([PT]=\"A\" and [Urg]=\"5\") or [PT]=\"C\") then \"Acutely Unwell/ED Patients\" else \r\n\r\nif [Modality2]=\"Plain X-Ray\" and ([PT]=\"B\" or [PT]=\"D\" or [PT]=\"G\") and ([Urg]=\"5\" or [Urg]=\"3\") then \"Urgent GP/Urgent Outpatients\" else \r\n\r\nif ([Modality2]=\"Plain X-Ray\" or [Modality2]=\"Fluoro\" or [Modality2]=\"Nuc Med\" or [Modality2]=\"Dexa\") and ([PT]=\"B\" or [PT]=\"D\" or [PT]=\"G\") and [Urg]=\"1\" then \"Routine GP and outpatients\" else  \r\n\r\nif [Modality2]=\"NOUS\" or [Modality2]=\"IR\" then \"Ultrasound and interventional Radiology\" else \"Other\"), {{\"Tat Type\", type text}}),\r\n  Activity = Table.TransformColumnTypes(Table.AddColumn(#\"Tat Type\", \"Activity.1\", each if([Status Code]=\"ASACK\" or [Status Code]=\"ASRMS\" or [Status Code]=\"ASRQS\" or [Status Code]=\"ATN\" or  [Status Code]=\"ATP\" or [Status Code]=\"CHBU\" or  [Status Code]=\"CHE\" or [Status Code]=\"CHEC\" or [Status Code]=\"CPC\" or [Status Code]=\"CPDNA\" or [Status Code]=\"CPMP\" or [Status Code]=\"CPPG\" or [Status Code]=\"CPPR\" or [Status Code]=\"CPR\" or [Status Code]=\"DVR\" or [Status Code]=\"PRTRPT\") then 1 else 0), {{\"Activity.1\", type number}}),\r\n  #\"Activity 2\" = Table.TransformColumnTypes(Table.AddColumn(Activity, \"Count of Activty_Demand for Activity.1\", each [Activity.1]), {{\"Count of Activty_Demand for Activity.1\", Int64.Type}}),\r\n  #\"Inserted merged column\" = Table.AddColumn(#\"Activity 2\", \"ExamSite Code\", each Text.Combine({[Site], [Room]}, \"\"), type text) in #\"Inserted merged column\";\r\n",
					"documentLocale": "en-us"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/dataflow1')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "AzureSql_CORE",
								"type": "DatasetReference"
							},
							"name": "AzureSqlCORE"
						},
						{
							"dataset": {
								"referenceName": "AzureSql_Patients",
								"type": "DatasetReference"
							},
							"name": "source1"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "AzureSqlCOREStageStep1",
								"type": "DatasetReference"
							},
							"name": "AzureSqlCOREStageStep1"
						}
					],
					"transformations": [
						{
							"name": "AddColumns"
						},
						{
							"name": "window1"
						},
						{
							"name": "lookup1"
						}
					],
					"scriptLines": [
						"source(output(",
						"          {CRIS No} as integer,",
						"          Accession as string,",
						"          {Ref Src} as string,",
						"          {Referring Locat} as string,",
						"          Referrer as string,",
						"          Speciality as string,",
						"          GP as string,",
						"          Practice as string,",
						"          {Postcode L} as string,",
						"          {Postcode R} as string,",
						"          Site as string,",
						"          {Request Date} as timestamp,",
						"          {Event Date} as timestamp,",
						"          {Event Time} as string,",
						"          {On Call} as string,",
						"          PT as string,",
						"          RC as string,",
						"          Examination as string,",
						"          {Exam Name} as string,",
						"          Room as string,",
						"          {Start Time} as string,",
						"          {End Time} as string,",
						"          {Radiographer 1} as string,",
						"          {Radiographer 2} as string,",
						"          {Required Clinician} as string,",
						"          {Contrast Code} as string,",
						"          {Qty Used} as decimal(6,2),",
						"          {Exam Key} as integer,",
						"          {Event Key} as integer,",
						"          {Status Code} as string,",
						"          {Booked Date} as timestamp,",
						"          {Booked Time} as string,",
						"          {Creation Date} as timestamp,",
						"          Attended as string,",
						"          {Event Key2} as integer,",
						"          {Lead Clinician} as string,",
						"          {Intended Radiologist} as string,",
						"          Urg as string,",
						"          {Referring Locat Name } as string,",
						"          {Referrer Name} as string,",
						"          Modality as string,",
						"          {No of Proc} as integer,",
						"          {GP Name} as string,",
						"          {Planned Appointment Date} as timestamp,",
						"          {Date First Verified} as timestamp,",
						"          {Reported By} as string,",
						"          {Reported By2} as string,",
						"          {Reported By2 Name} as string,",
						"          {Reported By Name} as string,",
						"          {Time First Verified} as string,",
						"          {Time Taken} as integer,",
						"          {Typed By} as string,",
						"          {Was Planned} as string,",
						"          {Was Scheduled} as string,",
						"          {Was Waiting} as string,",
						"          CCG as string,",
						"          Postcode as string,",
						"          {Day of Week} as string,",
						"          {Stat Date} as timestamp",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> AzureSqlCORE",
						"source(output(",
						"          {CRIS No} as integer,",
						"          {Creation Date} as timestamp,",
						"          {Mutation Date} as timestamp,",
						"          DOB as timestamp,",
						"          {Event Date} as timestamp,",
						"          DOD as timestamp,",
						"          {Ethnic Origin} as string,",
						"          GP as string,",
						"          {No of Attends} as integer,",
						"          {No of Events} as integer,",
						"          {Ref Src} as string,",
						"          {Postcode L} as string,",
						"          {Postcode R} as string,",
						"          Gender as string,",
						"          {Referrer Name} as string,",
						"          {Age at Event} as integer,",
						"          {HIS ID} as string,",
						"          CCG as string,",
						"          Postcode as string,",
						"          {Stat Date} as timestamp",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> source1",
						"AzureSqlCORE derive({Status Code.1} = toString(null()),",
						"          {Status Date} = toString(null()),",
						"          {Status Time} = toString(null()),",
						"          {Status Time2} = lpad(toString(null()),4,\"0\"),",
						"          Modality2 = toString(null()),",
						"          {Trust Name} = toString(null()),",
						"          Patient_Type = toString(null()),",
						"          {Tat Type} = toString(null()),",
						"          Activity = toString(null()),",
						"          {Count of Activty_Demand for Activity} = toString(null()),",
						"          {ExamSite Code} = toString(null()),",
						"          {Age at Event} = toString(null())) ~> AddColumns",
						"AddColumns window(over({Exam Key}),",
						"     desc({Stat Date}, false),",
						"     Rank = denseRank()) ~> window1",
						"window1, source1 lookup(AzureSqlCORE@{CRIS No} == source1@{CRIS No}",
						"     && AzureSqlCORE@{Event Date} == source1@{Event Date},",
						"     multiple: true,",
						"     broadcast: 'auto')~> lookup1",
						"lookup1 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          {CRIS No} as integer,",
						"          Accession as string,",
						"          {Ref Src} as string,",
						"          Site as string,",
						"          {Request Date} as timestamp,",
						"          {Event Date} as timestamp,",
						"          {Event Time} as string,",
						"          {On Call} as string,",
						"          PT as string,",
						"          Examination as string,",
						"          {Exam Name} as string,",
						"          Room as string,",
						"          {ExamSite Code} as string,",
						"          {Start Time} as string,",
						"          {End Time} as string,",
						"          {Exam Key} as integer,",
						"          {Event Key} as integer,",
						"          {Status Code} as string,",
						"          {Booked Date} as timestamp,",
						"          {Booked Time} as string,",
						"          {Creation Date} as timestamp,",
						"          Attended as string,",
						"          Urg as string,",
						"          Modality as string,",
						"          {No of Proc} as integer,",
						"          {Planned Appointment Date} as timestamp,",
						"          {Date First Verified} as timestamp,",
						"          {Time First Verified} as string,",
						"          {Was Planned} as string,",
						"          {Was Scheduled} as string,",
						"          {Was Waiting} as string,",
						"          {Stat Date} as timestamp,",
						"          Modality2 as string,",
						"          {Trust Name} as string,",
						"          Patient_Type as string,",
						"          {Tat Type} as string,",
						"          {Status Time} as string,",
						"          {Reported By} as string,",
						"          Rank as integer,",
						"          {Age At Event} as string",
						"     ),",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     truncate:true,",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1,",
						"     errorHandlingOption: 'stopOnFirstError',",
						"     mapColumn(",
						"          {CRIS No},",
						"          Accession,",
						"          {Ref Src},",
						"          Site,",
						"          {Request Date},",
						"          {Event Date},",
						"          {Event Time},",
						"          {On Call},",
						"          PT,",
						"          Examination,",
						"          {Exam Name},",
						"          Room,",
						"          {ExamSite Code},",
						"          {Start Time},",
						"          {End Time},",
						"          {Exam Key},",
						"          {Event Key},",
						"          {Status Code},",
						"          {Booked Date},",
						"          {Booked Time},",
						"          {Creation Date},",
						"          Attended,",
						"          Urg,",
						"          Modality,",
						"          {No of Proc},",
						"          {Planned Appointment Date},",
						"          {Date First Verified},",
						"          {Time First Verified},",
						"          {Was Planned},",
						"          {Was Scheduled},",
						"          {Was Waiting},",
						"          {Stat Date},",
						"          Modality2,",
						"          {Trust Name},",
						"          Patient_Type,",
						"          {Tat Type},",
						"          {Status Time} = {Status Time2},",
						"          {Reported By},",
						"          Rank,",
						"          {Age At Event} = source1@{Age at Event}",
						"     )) ~> AzureSqlCOREStageStep1"
					]
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/dataflow1_copy1')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "AzureSql_PTL",
								"type": "DatasetReference"
							},
							"name": "AzureSqlPTL"
						},
						{
							"dataset": {
								"referenceName": "Referral_Source",
								"type": "DatasetReference"
							},
							"name": "ReferralSource"
						},
						{
							"dataset": {
								"referenceName": "Exam",
								"type": "DatasetReference"
							},
							"name": "Exam"
						},
						{
							"dataset": {
								"referenceName": "Trust",
								"type": "DatasetReference"
							},
							"name": "Trust"
						},
						{
							"dataset": {
								"referenceName": "Modality",
								"type": "DatasetReference"
							},
							"name": "Modality"
						},
						{
							"dataset": {
								"referenceName": "Exam_Site",
								"type": "DatasetReference"
							},
							"name": "ExamSite"
						},
						{
							"dataset": {
								"referenceName": "AzureSqlCOREStageStep2",
								"type": "DatasetReference"
							},
							"name": "source1"
						},
						{
							"dataset": {
								"referenceName": "AzureSql_STATUSES",
								"type": "DatasetReference"
							},
							"name": "source2"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "ODBC_PTL_v2",
								"type": "DatasetReference"
							},
							"name": "AzureSqlPTLV2Staging"
						}
					],
					"transformations": [
						{
							"name": "AddColumns"
						},
						{
							"name": "SelectMostRecent"
						},
						{
							"name": "SortColumns"
						},
						{
							"name": "CreateID"
						},
						{
							"name": "RenameandRemoveCols"
						},
						{
							"name": "lookupReferralSource"
						},
						{
							"name": "lookupExam"
						},
						{
							"name": "DeriveTrust"
						},
						{
							"name": "lookupTrust"
						},
						{
							"name": "deriveModlaityCode"
						},
						{
							"name": "lookupModality"
						},
						{
							"name": "derivedEamsiteCode"
						},
						{
							"name": "lookupExamSite"
						},
						{
							"name": "RemoveCols"
						},
						{
							"name": "deriveBookedDateTime"
						},
						{
							"name": "RenameCols3"
						},
						{
							"name": "lookup1"
						},
						{
							"name": "filter1"
						},
						{
							"name": "sort1"
						}
					],
					"scriptLines": [
						"source(output(",
						"          {Event Key} as integer,",
						"          {Exam Key} as integer,",
						"          {CRIS Number} as integer,",
						"          {Status Category} as string,",
						"          Referrer as string,",
						"          {Ref Src} as string,",
						"          {Referring Location} as string,",
						"          Examination as string,",
						"          Site as string,",
						"          {Request Date} as timestamp,",
						"          {Event Date} as timestamp,",
						"          {Booked Time} as string,",
						"          {Booked Date} as timestamp,",
						"          {Ref Src2} as string,",
						"          {Postcode L} as string,",
						"          {Postcode R} as string,",
						"          {Creation Date} as timestamp,",
						"          {Event Key2} as integer,",
						"          Attended as string,",
						"          Modality as string,",
						"          Room as string,",
						"          RC as string,",
						"          Urg as integer,",
						"          {Referrer Name} as string,",
						"          {Exam Name} as string,",
						"          {Event Date2} as timestamp,",
						"          {Days Waiting} as integer,",
						"          {Predicted Reset Date} as timestamp,",
						"          {Waiting Time Reset Date} as timestamp,",
						"          {Weeks Waiting} as integer,",
						"          {Planned Appointment Date} as timestamp,",
						"          {Waiting Breach Date} as timestamp,",
						"          {Was Planned} as string,",
						"          {Was Scheduled} as string,",
						"          {Was Waiting} as string,",
						"          CCG as string,",
						"          {D Status} as string,",
						"          {Stat Date} as timestamp",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> AzureSqlPTL",
						"source(output(",
						"          {Referral Source} as string,",
						"          {Referral Source ID} as integer",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> ReferralSource",
						"source(output(",
						"          {Exam Name} as string,",
						"          {Exam Code} as string,",
						"          {Exam ID} as integer",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> Exam",
						"source(output(",
						"          {Trust Name} as string,",
						"          {Trust ID} as integer,",
						"          {Trust Name Group} as string,",
						"          {Trust Name Group2} as string,",
						"          {Trust Name Group3} as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> Trust",
						"source(output(",
						"          Modality2 as string,",
						"          {Modality ID} as integer",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> Modality",
						"source(output(",
						"          {Exam Site} as string,",
						"          {Exam Room} as string,",
						"          {Exam Site Code} as string,",
						"          {Exam Room ID} as integer",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> ExamSite",
						"source(output(",
						"          {CRIS No} as integer,",
						"          Accession as string,",
						"          {Ref Src} as string,",
						"          Site as string,",
						"          {Request Date} as date,",
						"          {Event Date} as date,",
						"          {Event Time} as string,",
						"          {On Call} as string,",
						"          PT as string,",
						"          Examination as string,",
						"          {Exam Name} as string,",
						"          Room as string,",
						"          {Start Time} as string,",
						"          {End Time} as string,",
						"          {Exam Key} as integer,",
						"          {Event Key} as integer,",
						"          {Status Code} as string,",
						"          {Booked Date} as timestamp,",
						"          {Booked Time} as string,",
						"          {Creation Date} as timestamp,",
						"          Attended as string,",
						"          Urg as string,",
						"          Modality as string,",
						"          {No of Proc} as integer,",
						"          {Planned Appointment Date} as timestamp,",
						"          {Date First Verified} as timestamp,",
						"          {Time First Verified} as string,",
						"          {Was Planned} as string,",
						"          {Was Scheduled} as string,",
						"          {Was Waiting} as string,",
						"          {Stat Date} as timestamp,",
						"          {Reported By} as string,",
						"          Rank as integer,",
						"          {Age At Event} as string,",
						"          {Status Code.2} as string,",
						"          {Status Date.1} as timestamp,",
						"          {Status Time} as string,",
						"          Modality2 as string,",
						"          {Trust Name} as string,",
						"          Patient_Type as string,",
						"          {Tat Type} as string,",
						"          {Activity.1} as integer,",
						"          {Count of Activty_Demand for Activity.1} as long,",
						"          {ExamSite Code} as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> source1",
						"source(output(",
						"          {Exam Key} as integer,",
						"          {Event Key} as integer,",
						"          Accession as string,",
						"          Referrer as string,",
						"          {Referral Location} as string,",
						"          {Referral Source} as string,",
						"          Urg as string,",
						"          Site as string,",
						"          {Status Code} as string,",
						"          {Status Date} as timestamp,",
						"          {Status Time} as integer,",
						"          {Referral Location Name} as string,",
						"          {Referral Source Name} as string,",
						"          {Referral Name} as string,",
						"          {Examination Name} as string,",
						"          Modality as string,",
						"          {Status Code at State Date} as string,",
						"          {Stat Date} as timestamp,",
						"          {D Status} as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> source2",
						"AzureSqlPTL derive({5 Weeks Wait} = iif({Weeks Waiting}>=6,1,0),",
						"          {Booked Datetime} = toString(null()),",
						"          {6 Weeks Wait} = toString(null()),",
						"          {Stat Date} = toDate({Stat Date})) ~> AddColumns",
						"CreateID filter(rank==1) ~> SelectMostRecent",
						"AddColumns sort(desc({Stat Date}, true)) ~> SortColumns",
						"SortColumns rank(desc({Stat Date}, true),",
						"     output(rank as long)) ~> CreateID",
						"SelectMostRecent select(mapColumn(",
						"          {Event Key},",
						"          {Exam Key},",
						"          {CRIS Number},",
						"          {Status Category},",
						"          {Ref Src},",
						"          Examination,",
						"          Site,",
						"          {Request Date},",
						"          {Event Date},",
						"          {Booked Time},",
						"          {Booked Date},",
						"          {Ref Src2},",
						"          {Creation Date},",
						"          Attended,",
						"          Modality,",
						"          Room,",
						"          Urg,",
						"          {Exam Name},",
						"          {Days Waiting},",
						"          {Predicted Reset Date},",
						"          {Waiting Time Reset Date},",
						"          {Weeks Waiting},",
						"          {Planned Appointment Date},",
						"          {Waiting Breach Date},",
						"          {Was Planned},",
						"          {Was Scheduled},",
						"          {Was Waiting},",
						"          {Stat Date},",
						"          {5 Weeks Wait},",
						"          {Booked Datetime},",
						"          {6 Weeks Wait}",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> RenameandRemoveCols",
						"RenameandRemoveCols, ReferralSource lookup({Ref Src} == {Referral Source},",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> lookupReferralSource",
						"lookupReferralSource, Exam lookup(Examination == {Exam Code},",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> lookupExam",
						"lookupExamSite derive(Site = iif ({Site} == \"5HA16\", \"LUHFT\", iif ({Site} == \"5NL93\", \"LUHFT\", iif (left({Site},3) == \"REM\", \"LUHFT\", iif (left({Site},3) == \"RQ6\", \"LUHFT\",  iif (left({Site},3) == \"RQ6\", \"LUHFT\", iif (left({Site},3) == \"RQ6\", \"LUHFT\", iif (left({Site},3) == \"RQ6\", \"LUHFT\", iif (left({Site},3) == \"RBL\", \"WUTH\", iif (left({Site},3) == \"RBN\", \"STHK\", iif (left({Site},3) == \"RBQ\", \"LHCH\", iif (left({Site},3) == \"RBS\", \"Alder Hey\", iif (left({Site},3) == \"RBT\", \"MCH\", iif (left({Site},3) == \"REN\", \"CCC\" , iif (left({Site},3) == \"REP\", \"Womens\", iif (left({Site},3) == \"RET\", \"TWC\", iif (left({Site},3) == \"RJR\", \"COCH\", iif (left({Site},3) == \"RVY\", \"S&O\", iif (left({Site},3) == \"RWW\", \"WHH\", {Site}))))))))))))))))))) ~> DeriveTrust",
						"DeriveTrust, Trust lookup(Site == {Trust Name},",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> lookupTrust",
						"lookupExam derive(Modality = iif({Modality} == \"R\", \"Plain X-Ray\", iif({Modality} == \"A\", \"IR\", iif({Modality} == \"B\", \"Mammo\", iif({Modality} == \"C\", \"CT\", iif({Modality} == \"M\", \"MRI\", iif({Modality} == \"F\", \"Fluoro\", iif({Modality} == \"U\", \"NOUS\", iif({Modality} == \"Z\", \"Additional Workload\", iif({Modality} == \"O\", \"Obstetrics\", iif({Modality} == \"N\", \"Nuc Med\", iif({Modality} == \"H\", \"Cardio\", iif({Modality} == \"S\", \"DEXA\", iif({Modality} == \"Y\", \"Med Phys\", iif({Modality} == \"E\", \"Endo\", iif({Modality} == \"D\", \"Doppler\", \"other\")))))))))))))))) ~> deriveModlaityCode",
						"deriveModlaityCode, Modality lookup(Modality == Modality2,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> lookupModality",
						"lookupModality derive(Room = concat({Site},{Room})) ~> derivedEamsiteCode",
						"derivedEamsiteCode, ExamSite lookup(Room == {Exam Site Code},",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> lookupExamSite",
						"lookupTrust select(mapColumn(",
						"          {Event Key},",
						"          {Exam Key},",
						"          {CRIS Number},",
						"          {Status Category},",
						"          {Request Date},",
						"          {Event Date},",
						"          {Booked Time},",
						"          {Booked Date},",
						"          {Creation Date},",
						"          Attended,",
						"          Urg,",
						"          {Days Waiting},",
						"          {Predicted Reset Date},",
						"          {Waiting Time Reset Date},",
						"          {Weeks Waiting},",
						"          {Planned Appointment Date},",
						"          {Waiting Breach Date},",
						"          {Was Planned},",
						"          {Was Scheduled},",
						"          {Was Waiting},",
						"          {Stat Date},",
						"          {5 Weeks Wait},",
						"          {Booked Datetime},",
						"          {6 Weeks Wait},",
						"          {Referral Source ID},",
						"          {Exam ID},",
						"          {Modality ID},",
						"          {Exam Room ID},",
						"          {Trust ID}",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> RemoveCols",
						"RemoveCols derive({Booked Date} = toTimestamp(concatWS(\" \", left(toString({Booked Date}),10), concatWS(\":\",left({Booked Time}, 2), concatWS(\":\",right({Booked Time}, 2),\"00\"))))) ~> deriveBookedDateTime",
						"lookup1 select(mapColumn(",
						"          {Event Key} = RemoveCols@{Event Key},",
						"          {Exam Key} = RemoveCols@{Exam Key},",
						"          {CRIS Number},",
						"          {Status Category},",
						"          {Request Date} = RemoveCols@{Request Date},",
						"          {Event Date} = RemoveCols@{Event Date},",
						"          {Booked Date Time} = deriveBookedDateTime@{Booked Date},",
						"          {Creation Date} = RemoveCols@{Creation Date},",
						"          Attended = RemoveCols@Attended,",
						"          Urg = RemoveCols@Urg,",
						"          {Days Waiting},",
						"          {Predicted Reset Date},",
						"          {Waiting Time Reset Date},",
						"          {Weeks Waiting},",
						"          {Planned Appointment Date} = RemoveCols@{Planned Appointment Date},",
						"          {Waiting Breach Date},",
						"          {Was Planned} = RemoveCols@{Was Planned},",
						"          {Was Scheduled} = RemoveCols@{Was Scheduled},",
						"          {Was Waiting} = RemoveCols@{Was Waiting},",
						"          {Stat Date} = RemoveCols@{Stat Date},",
						"          {5 Weeks Wait},",
						"          {Booked Datetime},",
						"          {6 Weeks Wait},",
						"          {Referral Source ID},",
						"          {Exam ID},",
						"          {Modality ID},",
						"          {Exam Room ID},",
						"          {Trust ID},",
						"          {Status Code}",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> RenameCols3",
						"deriveBookedDateTime, filter1 lookup(RemoveCols@{Exam Key} == source1@{Exam Key},",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> lookup1",
						"source1 filter(Rank==1) ~> filter1",
						"source2 sort(desc({Status Date}, false)) ~> sort1",
						"RenameCols3 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          {Event Key} as integer,",
						"          {Exam Key} as integer,",
						"          {CRIS Number} as integer,",
						"          {Status Category} as string,",
						"          {Request Date} as timestamp,",
						"          {Event Date} as timestamp,",
						"          {Booked Date Time} as timestamp,",
						"          {Creation Date} as timestamp,",
						"          Attended as string,",
						"          Urg as integer,",
						"          {Days Waiting} as integer,",
						"          {Predicted Reset Date} as timestamp,",
						"          {Waiting Time Reset Date} as timestamp,",
						"          {Weeks Waiting} as integer,",
						"          {Planned Appointment Date} as timestamp,",
						"          {Waiting Breach Date} as timestamp,",
						"          {Was Planned} as string,",
						"          {Was Scheduled} as string,",
						"          {Was Waiting} as string,",
						"          {Stat Date} as date,",
						"          {5 Weeks Wait} as integer,",
						"          {Booked Datetime} as string,",
						"          {6 Weeks Wait} as string,",
						"          {Referral Source ID} as integer,",
						"          {Exam ID} as integer,",
						"          {Modality ID} as integer,",
						"          {Exam Room ID} as integer,",
						"          {Trust ID} as integer,",
						"          {Status Code} as string",
						"     ),",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     truncate:true,",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1,",
						"     errorHandlingOption: 'stopOnFirstError') ~> AzureSqlPTLV2Staging"
					]
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/dataflow2')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "AzureSQLPTL_V4_Staging",
								"type": "DatasetReference"
							},
							"name": "AzureSqlCOREV3Staging"
						},
						{
							"dataset": {
								"referenceName": "AzureSql_PTL",
								"type": "DatasetReference"
							},
							"name": "AzureSqlPTL"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "Tat_Type",
								"type": "DatasetReference"
							},
							"name": "TatType"
						},
						{
							"dataset": {
								"referenceName": "Trust",
								"type": "DatasetReference"
							},
							"name": "Trust"
						},
						{
							"dataset": {
								"referenceName": "Exam_Site",
								"type": "DatasetReference"
							},
							"name": "sink4"
						},
						{
							"dataset": {
								"referenceName": "Modality",
								"type": "DatasetReference"
							},
							"name": "Modality"
						},
						{
							"dataset": {
								"referenceName": "Status",
								"type": "DatasetReference"
							},
							"name": "Status"
						},
						{
							"dataset": {
								"referenceName": "Exam",
								"type": "DatasetReference"
							},
							"name": "Exam"
						},
						{
							"dataset": {
								"referenceName": "Patient_Type",
								"type": "DatasetReference"
							},
							"name": "PatientType"
						},
						{
							"dataset": {
								"referenceName": "Referral_Source",
								"type": "DatasetReference"
							},
							"name": "ReferralSource"
						}
					],
					"transformations": [
						{
							"name": "RenameColumns8"
						},
						{
							"name": "RemoveDupes8"
						},
						{
							"name": "RankColumns8"
						},
						{
							"name": "DropColumns8"
						},
						{
							"name": "DeriveColumn8"
						},
						{
							"name": "RenameColumns7"
						},
						{
							"name": "RemoveDupes7"
						},
						{
							"name": "DropColumns7"
						},
						{
							"name": "RankColumns7"
						},
						{
							"name": "DeriveColumn7"
						},
						{
							"name": "RenameColumns6"
						},
						{
							"name": "RemoveDupes6"
						},
						{
							"name": "DropColumns6"
						},
						{
							"name": "JointColumn6"
						},
						{
							"name": "RankColumns6"
						},
						{
							"name": "RenameColumns5"
						},
						{
							"name": "RemoveDupes5"
						},
						{
							"name": "DropColumns5"
						},
						{
							"name": "RankColumns5"
						},
						{
							"name": "RenameColumns4"
						},
						{
							"name": "RemoveDupes4"
						},
						{
							"name": "DropColumns4"
						},
						{
							"name": "RankColumns4"
						},
						{
							"name": "DeriveColumn4"
						},
						{
							"name": "RenameColumns3"
						},
						{
							"name": "RemoveDupes3"
						},
						{
							"name": "DropColumns3"
						},
						{
							"name": "RankColumns3"
						},
						{
							"name": "RenameColumns2"
						},
						{
							"name": "RemoveDupes2"
						},
						{
							"name": "DropColumns2"
						},
						{
							"name": "RankColumns2"
						},
						{
							"name": "RenameColumns1"
						},
						{
							"name": "RemoveDupes1"
						},
						{
							"name": "DropColumns1"
						},
						{
							"name": "RankColumns1"
						},
						{
							"name": "SortColumns1"
						},
						{
							"name": "SortColumns2"
						},
						{
							"name": "SortColumns3"
						},
						{
							"name": "SortColumns4"
						},
						{
							"name": "SortColumns5"
						},
						{
							"name": "SortColumns6",
							"description": "Sorting rows on columns 'Exam Room ID'"
						},
						{
							"name": "SortColumns7"
						},
						{
							"name": "SortColumns8"
						},
						{
							"name": "RenameColumns9"
						},
						{
							"name": "CombineCOREPTL6"
						}
					],
					"scriptLines": [
						"source(output(",
						"          {CRIS No} as integer,",
						"          Accession as string,",
						"          {Ref Src} as string,",
						"          Site as string,",
						"          {Request Date} as date,",
						"          {Event Date} as date,",
						"          {Event Time} as string,",
						"          {On Call} as string,",
						"          PT as string,",
						"          Examination as string,",
						"          {Exam Name} as string,",
						"          Room as string,",
						"          {Start Time} as string,",
						"          {End Time} as string,",
						"          {Exam Key} as integer,",
						"          {Event Key} as integer,",
						"          {Status Code} as string,",
						"          {Booked Date} as timestamp,",
						"          {Booked Time} as string,",
						"          {Creation Date} as timestamp,",
						"          Attended as string,",
						"          Urg as string,",
						"          Modality as string,",
						"          {No of Proc} as integer,",
						"          {Age At Event} as integer,",
						"          {Planned Appointment Date} as timestamp,",
						"          {Date First Verified} as timestamp,",
						"          {Time First Verified} as string,",
						"          {Was Planned} as string,",
						"          {Was Scheduled} as string,",
						"          {Was Waiting} as string,",
						"          {Stat Date} as timestamp,",
						"          {Reported By} as string,",
						"          Rank as integer,",
						"          {Status Code.2} as string,",
						"          {Status Date.1} as timestamp,",
						"          {Status Time} as string,",
						"          Modality2 as string,",
						"          {Trust Name} as string,",
						"          Patient_Type as string,",
						"          {Tat Type} as string,",
						"          {Activity.1} as integer,",
						"          {Count of Activty_Demand for Activity.1} as long,",
						"          {ExamSite Code} as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> AzureSqlCOREV3Staging",
						"source(output(",
						"          {Event Key} as integer,",
						"          {Exam Key} as integer,",
						"          {CRIS Number} as integer,",
						"          {Status Category} as string,",
						"          Referrer as string,",
						"          {Ref Src} as string,",
						"          {Referring Location} as string,",
						"          Examination as string,",
						"          Site as string,",
						"          {Request Date} as timestamp,",
						"          {Event Date} as timestamp,",
						"          {Booked Time} as string,",
						"          {Booked Date} as timestamp,",
						"          {Ref Src2} as string,",
						"          {Postcode L} as string,",
						"          {Postcode R} as string,",
						"          {Creation Date} as timestamp,",
						"          {Event Key2} as integer,",
						"          Attended as string,",
						"          Modality as string,",
						"          Room as string,",
						"          RC as string,",
						"          Urg as integer,",
						"          {Referrer Name} as string,",
						"          {Exam Name} as string,",
						"          {Event Date2} as timestamp,",
						"          {Days Waiting} as integer,",
						"          {Predicted Reset Date} as timestamp,",
						"          {Waiting Time Reset Date} as timestamp,",
						"          {Weeks Waiting} as integer,",
						"          {Planned Appointment Date} as timestamp,",
						"          {Waiting Breach Date} as timestamp,",
						"          {Was Planned} as string,",
						"          {Was Scheduled} as string,",
						"          {Was Waiting} as string,",
						"          CCG as string,",
						"          {D Status} as string,",
						"          {Stat Date} as timestamp",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> AzureSqlPTL",
						"AzureSqlCOREV3Staging select(mapColumn(",
						"          {Tat Type}",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> RenameColumns8",
						"RenameColumns8 aggregate(groupBy({Tat Type}),",
						"     First = first({Tat Type})) ~> RemoveDupes8",
						"DropColumns8 rank(asc({Tat Type}, true),",
						"     output({Tat Type ID} as long),",
						"     dense: true) ~> RankColumns8",
						"RemoveDupes8 select(mapColumn(",
						"          {Tat Type}",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> DropColumns8",
						"RankColumns8 derive(Target = iif({Tat Type} == \"Urgent Inpatients\",\"12 hours\",iif({Tat Type} == \"Non-Urgent Inpatients\", \"24 hours\",iif({Tat Type} == \"Outpatient Faster Diagnosis Standard Cancer Pathway\", \"3 days\",iif({Tat Type} == \"Urgent GP and Outpatients\", \"7 days\",iif({Tat Type} == \"All Other Routine Outpatient and GP Studies\", \"28 days\",iif({Tat Type} == \"Acutely Unwell/ED Patients\", \"12 hours\",iif({Tat Type} == \"Other Inpatients\" , \"7 days\",iif({Tat Type} == \"Urgent GP/Urgent Outpatients\", \"7 days\",iif({Tat Type} == \"Routine GP and outpatients\", \"28 days\",iif({Tat Type} == \"Ultrasound and interventional Radiology\", \"3 hours\",\"0\"))))))))))) ~> DeriveColumn8",
						"AzureSqlCOREV3Staging select(mapColumn(",
						"          {Trust Name}",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> RenameColumns7",
						"RenameColumns7 aggregate(groupBy({Trust Name}),",
						"     First = first({Trust Name})) ~> RemoveDupes7",
						"RemoveDupes7 select(mapColumn(",
						"          {Trust Name}",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> DropColumns7",
						"DropColumns7 rank(asc({Trust Name}, true),",
						"     output({Trust ID} as long),",
						"     dense: true) ~> RankColumns7",
						"RankColumns7 derive({Trust Name Group} = iif( {Trust Name} == \"Womens\", \"REP\", iif( {Trust Name} == \"LUHFT\", \"REM\", iif( {Trust Name} == \"WUTH\", \"RBL\", iif( {Trust Name} == \"STHK\", \"RBN\", iif( {Trust Name} == \"S&O\", \"RVY\", iif( {Trust Name} == \"LHCH\", \"RBQ\", iif( {Trust Name} == \"Alder Hey\", \"RBS\", iif( {Trust Name} == \"MCH\", \"RBT\", iif( {Trust Name} == \"CCC\", \"REN\", iif( {Trust Name} == \"TWC\", \"RET\", iif( {Trust Name} == \"COCH\", \"RJR\", iif( {Trust Name} == \"WHH\", \"RWW\", iif( {Trust Name} == \"5M501\", \"REM\", iif( {Trust Name} == \"NTD05\", \"REM\", \"Other\")))))))))))))),",
						"          {Trust Name Group2} = iif( {Trust Name} == \"Womens\", \"Womens\", iif( {Trust Name} == \"LUHFT\", \"LUHFT\", iif( {Trust Name} == \"WUTH\", \"WUTH\", iif( {Trust Name} == \"STHK\", \"STHK\", iif( {Trust Name} == \"S&O\", \"S&O\", iif( {Trust Name} == \"LHCH\", \"LHCH\", iif( {Trust Name} == \"Alder Hey\", \"Alder Hey\", iif( {Trust Name} == \"MCH\", \"MCH\", iif( {Trust Name} == \"CCC\", \"CCC\", iif( {Trust Name} == \"TWC\", \"TWC\", iif( {Trust Name} == \"COCH\", \"COCH\", iif( {Trust Name} == \"WHH\", \"WHH\", iif( {Trust Name} == \"5M501\", \"LUHFT\", iif( {Trust Name} == \"NTD05\", \"LUHFT\", \"Other\")))))))))))))),",
						"          {Trust Name Group3} = iif( {Trust Name} == \"Womens\", \"REP\", iif( {Trust Name} == \"LUHFT\", \"REM\", iif( {Trust Name} == \"WUTH\", \"WUTH\", iif( {Trust Name} == \"STHK\", \"RBN\", iif( {Trust Name} == \"S&O\", \"RVY\", iif( {Trust Name} == \"LHCH\", \"RBQ\", iif( {Trust Name} == \"Alder Hey\", \"RBS\", iif( {Trust Name} == \"MCH\", \"RBT\", iif( {Trust Name} == \"CCC\", \"REN\", iif( {Trust Name} == \"TWC\", \"RET\", iif( {Trust Name} == \"COCH\", \"COCH\", iif( {Trust Name} == \"WHH\", \"RWW\", \"Other\"))))))))))))) ~> DeriveColumn7",
						"AzureSqlCOREV3Staging select(mapColumn(",
						"          {Exam Site} = Site,",
						"          {Exam Room} = Room",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> RenameColumns6",
						"CombineCOREPTL6 aggregate(groupBy({Exam Site},",
						"          {Exam Room}),",
						"     First = first({Exam Room})) ~> RemoveDupes6",
						"RemoveDupes6 select(mapColumn(",
						"          {Exam Site},",
						"          {Exam Room}",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> DropColumns6",
						"DropColumns6 derive({ExamSite Code} = iifNull({Exam Site},'\\n',{Exam Site})+iifNull({Exam Room},'\\n',{Exam Room})) ~> JointColumn6",
						"JointColumn6 rank(asc({ExamSite Code}, true),",
						"     output({Exam Room ID} as long)) ~> RankColumns6",
						"AzureSqlCOREV3Staging select(mapColumn(",
						"          Modality2",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> RenameColumns5",
						"RenameColumns5 aggregate(groupBy(Modality2),",
						"     First = first({Modality2})) ~> RemoveDupes5",
						"RemoveDupes5 select(mapColumn(",
						"          Modality2",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> DropColumns5",
						"DropColumns5 rank(asc(Modality2, true),",
						"     output({Modality ID} as long)) ~> RankColumns5",
						"AzureSqlCOREV3Staging select(mapColumn(",
						"          {Status Code}",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> RenameColumns4",
						"RenameColumns4 aggregate(groupBy({Status Code}),",
						"     First = first({Status Code})) ~> RemoveDupes4",
						"RemoveDupes4 select(mapColumn(",
						"          {Status Code}",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> DropColumns4",
						"DropColumns4 rank(asc({Status Code}, true),",
						"     output({Status ID} as long)) ~> RankColumns4",
						"RankColumns4 derive({Status Category} = iif(startsWith({Status Code}, \"AP\"), \"AP\", iif(startsWith({Status Code}, \"AS\"), \"AS\", iif(startsWith({Status Code}, \"AT\"), \"AT\", iif(startsWith({Status Code}, \"C\"), \"C\", iif(startsWith({Status Code}, \"D\"), \"D\", iif(startsWith({Status Code}, \"E\"), \"E\", iif(startsWith({Status Code}, \"P\"), \"P\", iif(startsWith({Status Code}, \"R\"), \"R\", iif(startsWith({Status Code}, \"V\"), \"V\", iif(startsWith({Status Code}, \"W\"), \"W\", iif({Status Code} == \"BHSRAI\", \"ST\", iif({Status Code} == \"ACNCLI\", \"W\", iif({Status Code} == \"SRREPC\", \"ST\", \"0\")))))))))))))) ~> DeriveColumn4",
						"AzureSqlCOREV3Staging select(mapColumn(",
						"          {Exam Code} = Examination,",
						"          {Exam Name}",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> RenameColumns3",
						"RenameColumns3 aggregate(groupBy({Exam Code},",
						"          {Exam Name}),",
						"     first = first({Exam Code})) ~> RemoveDupes3",
						"RemoveDupes3 select(mapColumn(",
						"          {Exam Code},",
						"          {Exam Name}",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> DropColumns3",
						"DropColumns3 rank(asc({Exam Code}, true),",
						"     output({Exam ID} as long)) ~> RankColumns3",
						"AzureSqlCOREV3Staging select(mapColumn(",
						"          Patient_Type",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> RenameColumns2",
						"RenameColumns2 aggregate(groupBy(Patient_Type),",
						"     first = first({Patient_Type})) ~> RemoveDupes2",
						"RemoveDupes2 select(mapColumn(",
						"          Patient_Type",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> DropColumns2",
						"DropColumns2 rank(asc(Patient_Type, true),",
						"     output({Patient Type ID} as long)) ~> RankColumns2",
						"AzureSqlCOREV3Staging select(mapColumn(",
						"          {Referral Source} = {Ref Src}",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> RenameColumns1",
						"RenameColumns1 aggregate(groupBy({Referral Source}),",
						"     first = first({Referral Source})) ~> RemoveDupes1",
						"RemoveDupes1 select(mapColumn(",
						"          {Referral Source}",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> DropColumns1",
						"DropColumns1 rank(asc({Referral Source}, true),",
						"     output({Referral Source ID} as long)) ~> RankColumns1",
						"RankColumns1 sort(asc({Referral Source ID}, true)) ~> SortColumns1",
						"RankColumns2 sort(asc({Patient Type ID}, true)) ~> SortColumns2",
						"RankColumns3 sort(asc({Exam ID}, true)) ~> SortColumns3",
						"DeriveColumn4 sort(asc({Status ID}, true)) ~> SortColumns4",
						"RankColumns5 sort(asc({Modality ID}, true)) ~> SortColumns5",
						"RankColumns6 sort(asc({Exam Room ID}, true)) ~> SortColumns6",
						"DeriveColumn7 sort(asc({Trust ID}, true)) ~> SortColumns7",
						"DeriveColumn8 sort(asc({Tat Type ID}, true)) ~> SortColumns8",
						"AzureSqlPTL select(mapColumn(",
						"          {Exam Site} = Site,",
						"          {Exam Room} = Room",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> RenameColumns9",
						"RenameColumns6, RenameColumns9 union(byName: true)~> CombineCOREPTL6",
						"SortColumns8 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          {Tat Type} as string,",
						"          {Tat Type ID} as integer,",
						"          Target as string",
						"     ),",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     truncate:true,",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> TatType",
						"SortColumns7 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          {Trust Name} as string,",
						"          {Trust ID} as integer,",
						"          {Trust Name Group} as string,",
						"          {Trust Name Group2} as string,",
						"          {Trust Name Group3} as string",
						"     ),",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     truncate:true,",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> Trust",
						"SortColumns6 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          {Exam Site} as string,",
						"          {Exam Room} as string,",
						"          {Exam Site Code} as string,",
						"          {Exam Room ID} as integer",
						"     ),",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     truncate:true,",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> sink4",
						"SortColumns5 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          Modality2 as string,",
						"          {Modality ID} as integer",
						"     ),",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     truncate:true,",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> Modality",
						"SortColumns4 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          {Status Code} as string,",
						"          {Status ID} as integer,",
						"          {Status Category} as string",
						"     ),",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     truncate:true,",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> Status",
						"SortColumns3 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          {Exam Name} as string,",
						"          {Exam Code} as string,",
						"          {Exam ID} as integer",
						"     ),",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     truncate:true,",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> Exam",
						"SortColumns2 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          Patient_Type as string,",
						"          Patient_Type_ID as integer",
						"     ),",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     truncate:true,",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> PatientType",
						"SortColumns1 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          {Referral Source} as string,",
						"          {Referral Source ID} as integer",
						"     ),",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     truncate:true,",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> ReferralSource"
					]
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/dataflow3')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "AzureSqlCOREStageStep2",
								"type": "DatasetReference"
							},
							"name": "AzureSQLCoreV3Staging"
						},
						{
							"dataset": {
								"referenceName": "Patient_Type",
								"type": "DatasetReference"
							},
							"name": "PatientType"
						},
						{
							"dataset": {
								"referenceName": "Modality",
								"type": "DatasetReference"
							},
							"name": "Modality"
						},
						{
							"dataset": {
								"referenceName": "Status",
								"type": "DatasetReference"
							},
							"name": "Status"
						},
						{
							"dataset": {
								"referenceName": "Exam",
								"type": "DatasetReference"
							},
							"name": "Exam"
						},
						{
							"dataset": {
								"referenceName": "Exam_Site",
								"type": "DatasetReference"
							},
							"name": "ExamSite"
						},
						{
							"dataset": {
								"referenceName": "Trust",
								"type": "DatasetReference"
							},
							"name": "Trust"
						},
						{
							"dataset": {
								"referenceName": "Referral_Source",
								"type": "DatasetReference"
							},
							"name": "ReferralSource"
						},
						{
							"dataset": {
								"referenceName": "Tat_Type",
								"type": "DatasetReference"
							},
							"name": "TatType"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "FYF_ODBC_CORE_v2",
								"type": "DatasetReference"
							},
							"name": "AzureSqlCOREV2"
						}
					],
					"transformations": [
						{
							"name": "MapDrifted1",
							"description": "Creates an explicit mapping for each drifted column"
						},
						{
							"name": "MapDrifted2",
							"description": "Creates an explicit mapping for each drifted column"
						},
						{
							"name": "RemoveColumns6"
						},
						{
							"name": "MapDrifted3",
							"description": "Creates an explicit mapping for each drifted column"
						},
						{
							"name": "RemoveColumns1"
						},
						{
							"name": "RemoveColumns2"
						},
						{
							"name": "RemoveColumns3"
						},
						{
							"name": "RemoveColumns4"
						},
						{
							"name": "select6"
						},
						{
							"name": "RemoveColumns5"
						},
						{
							"name": "DerivedColumn1"
						},
						{
							"name": "RenameColumn"
						},
						{
							"name": "LookupPatientType"
						},
						{
							"name": "lookupModality"
						},
						{
							"name": "lookupStatus"
						},
						{
							"name": "lookupExam"
						},
						{
							"name": "lookupExamSite"
						},
						{
							"name": "lookup6"
						},
						{
							"name": "lookupReferralSource"
						},
						{
							"name": "lookupTatType"
						},
						{
							"name": "RenameColumn2"
						},
						{
							"name": "MapDrifted4",
							"description": "Creates an explicit mapping for each drifted column"
						},
						{
							"name": "MapDrifted5",
							"description": "Creates an explicit mapping for each drifted column"
						},
						{
							"name": "filter1"
						}
					],
					"scriptLines": [
						"source(output(",
						"          {CRIS No} as integer,",
						"          Accession as string,",
						"          {Ref Src} as string,",
						"          Site as string,",
						"          {Request Date} as date,",
						"          {Event Date} as date,",
						"          {Event Time} as string,",
						"          {On Call} as string,",
						"          PT as string,",
						"          Examination as string,",
						"          {Exam Name} as string,",
						"          Room as string,",
						"          {Start Time} as string,",
						"          {End Time} as string,",
						"          {Exam Key} as integer,",
						"          {Event Key} as integer,",
						"          {Status Code} as string,",
						"          {Booked Date} as timestamp,",
						"          {Booked Time} as string,",
						"          {Creation Date} as timestamp,",
						"          Attended as string,",
						"          Urg as string,",
						"          Modality as string,",
						"          {No of Proc} as integer,",
						"          {Planned Appointment Date} as timestamp,",
						"          {Date First Verified} as timestamp,",
						"          {Time First Verified} as string,",
						"          {Was Planned} as string,",
						"          {Was Scheduled} as string,",
						"          {Was Waiting} as string,",
						"          {Stat Date} as timestamp,",
						"          {Reported By} as string,",
						"          Rank as integer,",
						"          {Age At Event} as string,",
						"          {Status Code.2} as string,",
						"          {Status Date.1} as timestamp,",
						"          {Status Time} as string,",
						"          Modality2 as string,",
						"          {Trust Name} as string,",
						"          Patient_Type as string,",
						"          {Tat Type} as string,",
						"          {Activity.1} as integer,",
						"          {Count of Activty_Demand for Activity.1} as long,",
						"          {ExamSite Code} as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> AzureSQLCoreV3Staging",
						"source(output(",
						"          Patient_Type as string,",
						"          Patient_Type_ID as integer",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> PatientType",
						"source(output(",
						"          Modality2 as string,",
						"          {Modality ID} as integer",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> Modality",
						"source(output(",
						"          {Status Code} as string,",
						"          {Status ID} as integer,",
						"          {Status Category} as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> Status",
						"source(output(",
						"          {Exam Name} as string,",
						"          {Exam Code} as string,",
						"          {Exam ID} as integer",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> Exam",
						"source(output(",
						"          {Exam Site} as string,",
						"          {Exam Room} as string,",
						"          {Exam Site Code} as string,",
						"          {Exam Room ID} as integer",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> ExamSite",
						"source(output(",
						"          {Trust Name} as string,",
						"          {Trust ID} as integer,",
						"          {Trust Name Group} as string,",
						"          {Trust Name Group2} as string,",
						"          {Trust Name Group3} as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> Trust",
						"source(output(",
						"          {Referral Source} as string,",
						"          {Referral Source ID} as integer",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> ReferralSource",
						"source(output(",
						"          {Tat Type} as string,",
						"          {Tat Type ID} as integer,",
						"          Target as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> TatType",
						"LookupPatientType derive({Patient Type ID} = toLong(byName('Patient Type ID'))) ~> MapDrifted1",
						"ExamSite derive({ExamSite Code} = toString(byName('ExamSite Code'))) ~> MapDrifted2",
						"lookupTatType select(mapColumn(",
						"          {CRIS No},",
						"          Accession,",
						"          {Ref Src},",
						"          Site,",
						"          {Request Date},",
						"          {Event Date},",
						"          {Event Time},",
						"          {On Call},",
						"          PT,",
						"          Examination,",
						"          {Exam Name},",
						"          Room,",
						"          {ExamSite Code},",
						"          {Start Time},",
						"          {End Time},",
						"          {Exam Key},",
						"          {Event Key},",
						"          {Status Code},",
						"          {Booked Date},",
						"          {Booked Time},",
						"          {Creation Date},",
						"          Attended,",
						"          Urg,",
						"          Modality,",
						"          {No of Proc},",
						"          {Planned Appointment Date},",
						"          {Date First Verified},",
						"          {Time First Verified},",
						"          {Was Planned},",
						"          {Was Scheduled},",
						"          {Was Waiting},",
						"          {Status Time},",
						"          Modality2,",
						"          {Trust Name},",
						"          Patient_Type,",
						"          {Tat Type} = RemoveColumns5@{Tat Type},",
						"          {Status Time2},",
						"          {Patient Type ID},",
						"          {Modality ID},",
						"          {Status ID},",
						"          {Exam ID},",
						"          {Exam Room ID},",
						"          {Trust ID},",
						"          {Referral Source ID},",
						"          {Tat Type ID},",
						"          {Reported By},",
						"          Rank,",
						"          {Status Code} = {Status Code.2},",
						"          {Status Date} = {Status Date.1},",
						"          Activity = {Activity.1},",
						"          {Count of Activty_Demand for Activity} = {Count of Activty_Demand for Activity.1},",
						"          {Stat Date},",
						"          {Age At Event}",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> RemoveColumns6",
						"PatientType derive({Patient Type ID} = toLong(byName('Patient Type ID'))) ~> MapDrifted3",
						"MapDrifted5 select(mapColumn(",
						"          {CRIS No},",
						"          Accession,",
						"          {Ref Src},",
						"          Site,",
						"          {Request Date},",
						"          {Event Date},",
						"          {Event Time},",
						"          {On Call},",
						"          PT,",
						"          Examination,",
						"          {Exam Name},",
						"          Room,",
						"          {ExamSite Code},",
						"          {Start Time},",
						"          {End Time},",
						"          {Exam Key},",
						"          {Event Key},",
						"          {Status Code},",
						"          {Booked Date},",
						"          {Booked Time},",
						"          {Creation Date},",
						"          Attended,",
						"          Urg,",
						"          Modality,",
						"          {No of Proc},",
						"          {Planned Appointment Date},",
						"          {Date First Verified},",
						"          {Time First Verified},",
						"          {Was Planned},",
						"          {Was Scheduled},",
						"          {Was Waiting},",
						"          {Stat Date},",
						"          {Status Time},",
						"          Modality2,",
						"          {Trust Name},",
						"          Patient_Type = AzureSQLCoreV3Staging@Patient_Type,",
						"          {Tat Type},",
						"          {Status Time2},",
						"          {Patient Type ID},",
						"          {Reported By},",
						"          Rank,",
						"          {Status Code.2},",
						"          {Status Date.1},",
						"          {Activity.1},",
						"          {Count of Activty_Demand for Activity.1},",
						"          {Stat Date},",
						"          {Age At Event}",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> RemoveColumns1",
						"lookupStatus select(mapColumn(",
						"          {CRIS No},",
						"          Accession,",
						"          {Ref Src},",
						"          Site,",
						"          {Request Date},",
						"          {Event Date},",
						"          {Event Time},",
						"          {On Call},",
						"          PT,",
						"          Examination,",
						"          {Exam Name},",
						"          Room,",
						"          {ExamSite Code},",
						"          {Start Time},",
						"          {End Time},",
						"          {Exam Key},",
						"          {Event Key},",
						"          {Status Code} = RemoveColumns1@{Status Code},",
						"          {Booked Date},",
						"          {Booked Time},",
						"          {Creation Date},",
						"          Attended,",
						"          Urg,",
						"          Modality,",
						"          {No of Proc},",
						"          {Planned Appointment Date},",
						"          {Date First Verified},",
						"          {Time First Verified},",
						"          {Was Planned},",
						"          {Was Scheduled},",
						"          {Was Waiting},",
						"          {Stat Date},",
						"          {Status Time},",
						"          Modality2 = RemoveColumns1@Modality2,",
						"          {Trust Name},",
						"          Patient_Type,",
						"          {Tat Type},",
						"          {Status Time2},",
						"          {Patient Type ID},",
						"          {Modality ID},",
						"          {Status ID},",
						"          {Reported By},",
						"          Rank,",
						"          {Status Code.2},",
						"          {Status Date.1},",
						"          {Activity.1},",
						"          {Count of Activty_Demand for Activity.1},",
						"          {Stat Date},",
						"          {Age At Event}",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> RemoveColumns2",
						"lookupExam select(mapColumn(",
						"          {CRIS No},",
						"          Accession,",
						"          {Ref Src},",
						"          Site,",
						"          {Request Date},",
						"          {Event Date},",
						"          {Event Time},",
						"          {On Call},",
						"          PT,",
						"          Examination,",
						"          {Exam Name} = RemoveColumns2@{Exam Name},",
						"          Room,",
						"          {ExamSite Code},",
						"          {Start Time},",
						"          {End Time},",
						"          {Exam Key},",
						"          {Event Key},",
						"          {Status Code},",
						"          {Booked Date},",
						"          {Booked Time},",
						"          {Creation Date},",
						"          Attended,",
						"          Urg,",
						"          Modality,",
						"          {No of Proc},",
						"          {Planned Appointment Date},",
						"          {Date First Verified},",
						"          {Time First Verified},",
						"          {Was Planned},",
						"          {Was Scheduled},",
						"          {Was Waiting},",
						"          {Status Time},",
						"          Modality2,",
						"          {Trust Name},",
						"          Patient_Type,",
						"          {Tat Type},",
						"          {Status Time2},",
						"          {Patient Type ID},",
						"          {Modality ID},",
						"          {Status ID},",
						"          {Exam ID},",
						"          {Reported By},",
						"          Rank,",
						"          {Status Code.2},",
						"          {Status Date.1},",
						"          {Activity.1},",
						"          {Count of Activty_Demand for Activity.1},",
						"          {Stat Date},",
						"          {Age At Event}",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> RemoveColumns3",
						"lookupExamSite select(mapColumn(",
						"          {CRIS No},",
						"          Accession,",
						"          {Ref Src},",
						"          Site,",
						"          {Request Date},",
						"          {Event Date},",
						"          {Event Time},",
						"          {On Call},",
						"          PT,",
						"          Examination,",
						"          {Exam Name},",
						"          Room,",
						"          {ExamSite Code} = RemoveColumns3@{ExamSite Code},",
						"          {Start Time},",
						"          {End Time},",
						"          {Exam Key},",
						"          {Event Key},",
						"          {Status Code},",
						"          {Booked Date},",
						"          {Booked Time},",
						"          {Creation Date},",
						"          Attended,",
						"          Urg,",
						"          Modality,",
						"          {No of Proc},",
						"          {Planned Appointment Date},",
						"          {Date First Verified},",
						"          {Time First Verified},",
						"          {Was Planned},",
						"          {Was Scheduled},",
						"          {Was Waiting},",
						"          {Status Time},",
						"          Modality2,",
						"          {Trust Name},",
						"          Patient_Type,",
						"          {Tat Type},",
						"          {Status Time2},",
						"          {Patient Type ID},",
						"          {Modality ID},",
						"          {Status ID},",
						"          {Exam ID},",
						"          {Exam Room ID},",
						"          {Reported By},",
						"          Rank,",
						"          {Status Code.2},",
						"          {Status Date.1},",
						"          {Activity.1},",
						"          {Count of Activty_Demand for Activity.1},",
						"          {Stat Date},",
						"          {Age At Event}",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> RemoveColumns4",
						"lookup6 select(mapColumn(",
						"          {CRIS No},",
						"          Accession,",
						"          {Ref Src},",
						"          Site,",
						"          {Request Date},",
						"          {Event Date},",
						"          {Event Time},",
						"          {On Call},",
						"          PT,",
						"          Examination,",
						"          {Exam Name},",
						"          Room,",
						"          {ExamSite Code},",
						"          {Start Time},",
						"          {End Time},",
						"          {Exam Key},",
						"          {Event Key},",
						"          {Status Code},",
						"          {Booked Date},",
						"          {Booked Time},",
						"          {Creation Date},",
						"          Attended,",
						"          Urg,",
						"          Modality,",
						"          {No of Proc},",
						"          {Planned Appointment Date},",
						"          {Date First Verified},",
						"          {Time First Verified},",
						"          {Was Planned},",
						"          {Was Scheduled},",
						"          {Was Waiting},",
						"          {Status Time},",
						"          Modality2,",
						"          {Trust Name} = RemoveColumns4@{Trust Name},",
						"          Patient_Type,",
						"          {Tat Type},",
						"          {Status Time2},",
						"          {Patient Type ID},",
						"          {Modality ID},",
						"          {Status ID},",
						"          {Exam ID},",
						"          {Exam Room ID},",
						"          {Trust ID},",
						"          {Reported By},",
						"          Rank,",
						"          {Status Code.2},",
						"          {Status Date.1},",
						"          {Activity.1},",
						"          {Count of Activty_Demand for Activity.1},",
						"          {Stat Date},",
						"          {Age At Event}",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> select6",
						"lookupReferralSource select(mapColumn(",
						"          {CRIS No},",
						"          Accession,",
						"          {Ref Src},",
						"          Site,",
						"          {Request Date},",
						"          {Event Date},",
						"          {Event Time},",
						"          {On Call},",
						"          PT,",
						"          Examination,",
						"          {Exam Name},",
						"          Room,",
						"          {ExamSite Code},",
						"          {Start Time},",
						"          {End Time},",
						"          {Exam Key},",
						"          {Event Key},",
						"          {Status Code},",
						"          {Booked Date},",
						"          {Booked Time},",
						"          {Creation Date},",
						"          Attended,",
						"          Urg,",
						"          Modality,",
						"          {No of Proc},",
						"          {Planned Appointment Date},",
						"          {Date First Verified},",
						"          {Time First Verified},",
						"          {Was Planned},",
						"          {Was Scheduled},",
						"          {Was Waiting},",
						"          {Status Time},",
						"          Modality2,",
						"          {Trust Name},",
						"          Patient_Type,",
						"          {Tat Type},",
						"          {Status Time2},",
						"          {Patient Type ID},",
						"          {Modality ID},",
						"          {Status ID},",
						"          {Exam ID},",
						"          {Exam Room ID},",
						"          {Trust ID},",
						"          {Referral Source ID},",
						"          {Reported By},",
						"          Rank,",
						"          {Status Code.2},",
						"          {Status Date.1},",
						"          {Activity.1},",
						"          {Count of Activty_Demand for Activity.1},",
						"          {Stat Date},",
						"          {Age At Event}",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> RemoveColumns5",
						"MapDrifted4 derive({Status Time2} = lpad(toString({Status Time}),4,\"0\")) ~> DerivedColumn1",
						"MapDrifted3 select(mapColumn(",
						"          Patient_Type,",
						"          {Patient Type ID}",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> RenameColumn",
						"DerivedColumn1, RenameColumn lookup(AzureSQLCoreV3Staging@Patient_Type == RenameColumn@Patient_Type,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> LookupPatientType",
						"RemoveColumns1, Modality lookup(RemoveColumns1@Modality2 == Modality@Modality2,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> lookupModality",
						"lookupModality, Status lookup(RemoveColumns1@{Status Code} == Status@{Status Code},",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> lookupStatus",
						"RemoveColumns2, Exam lookup(Examination == {Exam Code},",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> lookupExam",
						"RemoveColumns3, MapDrifted2 lookup(RemoveColumns3@{ExamSite Code} == MapDrifted2@{ExamSite Code},",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> lookupExamSite",
						"RemoveColumns4, Trust lookup(RemoveColumns4@{Trust Name} == Trust@{Trust Name},",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> lookup6",
						"select6, ReferralSource lookup({Ref Src} == {Referral Source},",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> lookupReferralSource",
						"RemoveColumns5, TatType lookup(RemoveColumns5@{Tat Type} == TatType@{Tat Type},",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> lookupTatType",
						"MapDrifted2 select(mapColumn(",
						"          {Exam Site},",
						"          {Exam Room},",
						"          {Exam Room ID},",
						"          {ExamSite Code}",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> RenameColumn2",
						"filter1 derive({Reported By} = toString(byName('Reported By'))) ~> MapDrifted4",
						"MapDrifted1 derive({Reported By} = toString(byName('Reported By'))) ~> MapDrifted5",
						"AzureSQLCoreV3Staging filter(Rank==1) ~> filter1",
						"RemoveColumns6 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          {CRIS No} as integer,",
						"          Accession as string,",
						"          {Ref Src} as string,",
						"          Site as string,",
						"          {Request Date} as date,",
						"          {Event Date} as date,",
						"          {Event Time} as string,",
						"          {On Call} as string,",
						"          PT as string,",
						"          Examination as string,",
						"          {Exam Name} as string,",
						"          Room as string,",
						"          {ExamSite Code} as string,",
						"          {Start Time} as string,",
						"          {End Time} as string,",
						"          {Exam Key} as integer,",
						"          {Event Key} as integer,",
						"          {Status Code} as string,",
						"          {Booked Date} as timestamp,",
						"          {Booked Time} as string,",
						"          {Creation Date} as timestamp,",
						"          Attended as string,",
						"          Urg as string,",
						"          Modality as string,",
						"          {No of Proc} as integer,",
						"          {Planned Appointment Date} as timestamp,",
						"          {Date First Verified} as timestamp,",
						"          {Time First Verified} as string,",
						"          {Was Planned} as string,",
						"          {Was Scheduled} as string,",
						"          {Was Waiting} as string,",
						"          {Status Time} as string,",
						"          Modality2 as string,",
						"          {Trust Name} as string,",
						"          Patient_Type as string,",
						"          {Tat Type} as string,",
						"          {Status Time2} as string,",
						"          {Patient Type ID} as long,",
						"          {Modality ID} as integer,",
						"          {Status ID} as integer,",
						"          {Exam ID} as integer,",
						"          {Exam Room ID} as integer,",
						"          {Trust ID} as integer,",
						"          {Referral Source ID} as integer,",
						"          {Tat Type ID} as integer,",
						"          {Reported By} as string,",
						"          Rank as integer,",
						"          {Status Date} as timestamp,",
						"          Activity as integer,",
						"          {Count of Activty_Demand for Activity} as long,",
						"          {Stat Date} as timestamp,",
						"          {Age At Event} as string",
						"     ),",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     truncate:true,",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1,",
						"     errorHandlingOption: 'stopOnFirstError',",
						"     mapColumn(",
						"          {CRIS No},",
						"          Accession,",
						"          {Ref Src},",
						"          Site,",
						"          {Request Date},",
						"          {Event Date},",
						"          {Event Time},",
						"          {On Call},",
						"          PT,",
						"          Examination,",
						"          {Exam Name},",
						"          Room,",
						"          {ExamSite Code},",
						"          {Start Time},",
						"          {End Time},",
						"          {Exam Key},",
						"          {Event Key},",
						"          {Status Code},",
						"          {Booked Date},",
						"          {Booked Time},",
						"          {Creation Date},",
						"          Attended,",
						"          Urg,",
						"          Modality,",
						"          {No of Proc},",
						"          {Planned Appointment Date},",
						"          {Date First Verified},",
						"          {Time First Verified},",
						"          {Was Planned},",
						"          {Was Scheduled},",
						"          {Was Waiting},",
						"          {Status Time},",
						"          Modality2,",
						"          {Trust Name},",
						"          Patient_Type,",
						"          {Tat Type},",
						"          {Status Time2},",
						"          {Patient Type ID},",
						"          {Modality ID},",
						"          {Status ID},",
						"          {Exam ID},",
						"          {Exam Room ID},",
						"          {Trust ID},",
						"          {Referral Source ID},",
						"          {Tat Type ID},",
						"          {Reported By},",
						"          Rank,",
						"          {Status Date},",
						"          Activity,",
						"          {Count of Activty_Demand for Activity},",
						"          {Stat Date},",
						"          {Age At Event}",
						"     )) ~> AzureSqlCOREV2"
					]
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/dataflow4')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "AzureSql_STATUSES",
								"type": "DatasetReference"
							},
							"name": "source1"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "RequestRecievedStatus",
								"type": "DatasetReference"
							},
							"name": "sink1",
							"description": "Export data to Request Received Status"
						}
					],
					"transformations": [
						{
							"name": "window1"
						},
						{
							"name": "filter1"
						},
						{
							"name": "filter2"
						}
					],
					"scriptLines": [
						"source(output(",
						"          {Exam Key} as integer,",
						"          {Event Key} as integer,",
						"          Accession as string,",
						"          Referrer as string,",
						"          {Referral Location} as string,",
						"          {Referral Source} as string,",
						"          Urg as string,",
						"          Site as string,",
						"          {Status Code} as string,",
						"          {Status Date} as timestamp,",
						"          {Status Time} as integer,",
						"          {Referral Location Name} as string,",
						"          {Referral Source Name} as string,",
						"          {Referral Name} as string,",
						"          {Examination Name} as string,",
						"          Modality as string,",
						"          {Status Code at State Date} as string,",
						"          {Stat Date} as timestamp,",
						"          {D Status} as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> source1",
						"filter1 window(over({Exam Key}),",
						"     desc({Status Date}, false),",
						"     desc({Status Time}, false),",
						"     asc({Status Code at State Date}, false),",
						"     asc(Referrer, true),",
						"     asc({Referral Location}, true),",
						"     asc({Referral Source}, true),",
						"     asc(Urg, true),",
						"     asc(Site, true),",
						"     asc({Referral Location Name}, true),",
						"     asc({Referral Source Name}, true),",
						"     asc({Referral Name}, true),",
						"     asc({Examination Name}, true),",
						"     asc(Modality, true),",
						"     asc({Stat Date}, true),",
						"     asc({D Status}, true),",
						"     Rank = denseRank()) ~> window1",
						"source1 filter({Status Code}==\"RR\") ~> filter1",
						"window1 filter(Rank==1) ~> filter2",
						"filter2 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          {Exam Key} as integer,",
						"          {Event Key} as integer,",
						"          Accession as string,",
						"          Referrer as string,",
						"          {Referral Location} as string,",
						"          {Referral Source} as string,",
						"          Urg as string,",
						"          Site as string,",
						"          {Status Code} as string,",
						"          {Status Date} as timestamp,",
						"          {Status Time} as integer,",
						"          {Referral Location Name} as string,",
						"          {Referral Source Name} as string,",
						"          {Referral Name} as string,",
						"          {Examination Name} as string,",
						"          Modality as string,",
						"          {Status Code at State Date} as string,",
						"          {Stat Date} as timestamp,",
						"          {D Status} as string,",
						"          Rank as integer",
						"     ),",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     recreate:true,",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1,",
						"     errorHandlingOption: 'stopOnFirstError') ~> sink1"
					]
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/dataflow5')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "AzureSQLCoreV3Staging",
								"type": "DatasetReference"
							},
							"name": "source1"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "AzureSQLCoreV3Staging",
								"type": "DatasetReference"
							},
							"name": "sink1"
						}
					],
					"transformations": [
						{
							"name": "filter1"
						}
					],
					"scriptLines": [
						"source(output(",
						"          {CRIS No} as integer,",
						"          Accession as string,",
						"          {Ref Src} as string,",
						"          Site as string,",
						"          {Request Date} as date,",
						"          {Event Date} as date,",
						"          {Event Time} as string,",
						"          {On Call} as string,",
						"          PT as string,",
						"          Examination as string,",
						"          {Exam Name} as string,",
						"          Room as string,",
						"          {ExamSite Code} as string,",
						"          {Start Time} as string,",
						"          {End Time} as string,",
						"          {Exam Key} as integer,",
						"          {Event Key} as integer,",
						"          {Status Code} as string,",
						"          {Booked Date} as timestamp,",
						"          {Booked Time} as string,",
						"          {Creation Date} as timestamp,",
						"          Attended as string,",
						"          Urg as string,",
						"          Modality as string,",
						"          {No of Proc} as integer,",
						"          {Age At Event} as integer,",
						"          {Planned Appointment Date} as timestamp,",
						"          {Date First Verified} as timestamp,",
						"          {Time First Verified} as string,",
						"          {Was Planned} as string,",
						"          {Was Scheduled} as string,",
						"          {Was Waiting} as string,",
						"          {Stat Date} as timestamp,",
						"          Modality2 as string,",
						"          {Trust Name} as string,",
						"          Patient_Type as string,",
						"          {Tat Type} as string,",
						"          {Status Time} as string,",
						"          {Reported By} as string,",
						"          Rank as integer",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> source1",
						"source1 filter({Exam Key}==26213771) ~> filter1",
						"filter1 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          {CRIS No} as integer,",
						"          Accession as string,",
						"          {Ref Src} as string,",
						"          Site as string,",
						"          {Request Date} as date,",
						"          {Event Date} as date,",
						"          {Event Time} as string,",
						"          {On Call} as string,",
						"          PT as string,",
						"          Examination as string,",
						"          {Exam Name} as string,",
						"          Room as string,",
						"          {ExamSite Code} as string,",
						"          {Start Time} as string,",
						"          {End Time} as string,",
						"          {Exam Key} as integer,",
						"          {Event Key} as integer,",
						"          {Status Code} as string,",
						"          {Booked Date} as timestamp,",
						"          {Booked Time} as string,",
						"          {Creation Date} as timestamp,",
						"          Attended as string,",
						"          Urg as string,",
						"          Modality as string,",
						"          {No of Proc} as integer,",
						"          {Planned Appointment Date} as timestamp,",
						"          {Date First Verified} as timestamp,",
						"          {Time First Verified} as string,",
						"          {Was Planned} as string,",
						"          {Was Scheduled} as string,",
						"          {Was Waiting} as string,",
						"          {Stat Date} as timestamp,",
						"          Modality2 as string,",
						"          {Trust Name} as string,",
						"          Patient_Type as string,",
						"          {Tat Type} as string,",
						"          {Status Time} as string,",
						"          {Reported By} as string,",
						"          Rank as integer,",
						"          {Age At Event} as integer",
						"     ),",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     truncate:true,",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> sink1"
					]
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/dataflow6')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "FYF_ODBC_CORE_v2",
								"type": "DatasetReference"
							},
							"name": "source1"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "testtable2",
								"type": "DatasetReference"
							},
							"name": "sink1"
						},
						{
							"dataset": {
								"referenceName": "AIDF",
								"type": "DatasetReference"
							},
							"name": "sink3"
						}
					],
					"transformations": [
						{
							"name": "filter1"
						},
						{
							"name": "select1"
						},
						{
							"name": "select2"
						},
						{
							"name": "derivedColumn1"
						},
						{
							"name": "derivedColumn2"
						},
						{
							"name": "filter2"
						},
						{
							"name": "join1"
						},
						{
							"name": "derivedColumn3"
						},
						{
							"name": "filter3"
						},
						{
							"name": "select3"
						},
						{
							"name": "join2"
						},
						{
							"name": "window1"
						},
						{
							"name": "filter4"
						}
					],
					"scriptLines": [
						"source(output(",
						"          {CRIS No} as integer,",
						"          Accession as string,",
						"          {Ref Src} as string,",
						"          Site as string,",
						"          {Request Date} as date,",
						"          {Event Date} as date,",
						"          {Event Time} as string,",
						"          {On Call} as string,",
						"          PT as string,",
						"          Examination as string,",
						"          {Exam Name} as string,",
						"          Room as string,",
						"          {ExamSite Code} as string,",
						"          {Start Time} as string,",
						"          {End Time} as string,",
						"          {Exam Key} as integer,",
						"          {Event Key} as integer,",
						"          {Status Code} as string,",
						"          {Booked Date} as timestamp,",
						"          {Booked Time} as string,",
						"          {Creation Date} as timestamp,",
						"          Attended as string,",
						"          Urg as string,",
						"          Modality as string,",
						"          {No of Proc} as integer,",
						"          {Planned Appointment Date} as timestamp,",
						"          {Date First Verified} as timestamp,",
						"          {Time First Verified} as string,",
						"          {Was Planned} as string,",
						"          {Was Scheduled} as string,",
						"          {Was Waiting} as string,",
						"          {Status Time} as string,",
						"          Modality2 as string,",
						"          {Trust Name} as string,",
						"          Patient_Type as string,",
						"          {Tat Type} as string,",
						"          {Status Time2} as string,",
						"          {Patient Type ID} as long,",
						"          {Modality ID} as integer,",
						"          {Status ID} as integer,",
						"          {Exam ID} as integer,",
						"          {Exam Room ID} as integer,",
						"          {Trust ID} as integer,",
						"          {Referral Source ID} as integer,",
						"          {Tat Type ID} as integer,",
						"          {Reported By} as string,",
						"          Rank as integer,",
						"          {Status Date} as timestamp,",
						"          Activity as integer,",
						"          {Count of Activty_Demand for Activity} as long,",
						"          {Stat Date} as timestamp,",
						"          {Age At Event} as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> source1",
						"source1 filter(Examination == \"XCHES\" && {Event Date} >= toDate('01/01/2022','MM/dd/yyyy') && toDate({Date First Verified}) >= toDate('01/01/2022','MM/dd/yyyy')) ~> filter1",
						"filter2 select(mapColumn(",
						"          {CRIS No},",
						"          {Event Key},",
						"          {Exam Key},",
						"          {Trust ID},",
						"          {Exam Room ID},",
						"          {Event Date},",
						"          {Date First Verified},",
						"          {Reported By},",
						"          {Patient Type ID},",
						"          {Age At Event},",
						"          {Exam ID}",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> select1",
						"filter1 select(mapColumn(",
						"          {CRIS No},",
						"          {Event Key},",
						"          {Exam Key},",
						"          {Trust ID},",
						"          {Exam Room ID},",
						"          {Event Date},",
						"          {Date First Verified},",
						"          {Reported By},",
						"          {Patient Type ID},",
						"          {Age At Event},",
						"          {Exam ID}",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> select2",
						"select2 derive(Auto = iif(instr({Reported By},\"AUTO\")!=0, 1, 0),",
						"          {Rep Rad} = iif(startsWith({Reported By},\"RA\")==true(),1,0),",
						"          Cons = iif(startsWith({Reported By},\"C\")==true(),1,0),",
						"          Outsource = iif(instr({Reported By},\"4way\")!=0,1,iif(instr({Reported By},\"EXT\")!=0,1,iif(instr({Reported By},\"4WAY\")!=0,1,0))),",
						"          {CX I-R} = toDate({Date First Verified})-{Event Date},",
						"          Snapshot = iif(isNull({Date First Verified})==false(),iif(toDate({Date First Verified})>=toDate('10/01/2023','MM/dd/yyyy'),iif({Event Date}<=toDate('10/01/2023','MM/dd/yyyy'),1,0),0),0)) ~> derivedColumn1",
						"derivedColumn1 derive(Abnormal = iif(between({CX I-R}, 0, 28)==true(),1,0)) ~> derivedColumn2",
						"source1 filter(Examination == \"CCHES\" && {Event Date} >= toDate('01/01/2022','MM/dd/yyyy') && toDate({Date First Verified}) >= toDate('01/01/2022','MM/dd/yyyy')) ~> filter2",
						"derivedColumn2, select1 join(select2@{CRIS No} == select1@{CRIS No}",
						"     && select2@{Event Date} <= select1@{Event Date}",
						"     && toDate(select2@{Date First Verified}) <= select1@{Event Date},",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'right')~> join1",
						"join1 derive({CXR-CCI} = select1@{Event Date}-toDate(select2@{Date First Verified}),",
						"          {CXI-CCR} = toDate(select1@{Date First Verified})-select2@{Event Date},",
						"          {CXI-CCI} = select1@{Event Date}-select2@{Event Date}) ~> derivedColumn3",
						"select3 filter({CXR-CCI}<=28) ~> filter3",
						"derivedColumn3 select(mapColumn(",
						"          {CRIS No} = select1@{CRIS No},",
						"          {Event Key} = select1@{Event Key},",
						"          {CTExam Key} = select1@{Exam Key},",
						"          {Trust ID} = select1@{Trust ID},",
						"          {Exam Room ID} = select1@{Exam Room ID},",
						"          {Event Date} = select1@{Event Date},",
						"          {Date First Verified} = select1@{Date First Verified},",
						"          {Reported By} = select1@{Reported By},",
						"          {Patient Type ID} = select1@{Patient Type ID},",
						"          {Age At Event} = select1@{Age At Event},",
						"          {Exam ID} = select1@{Exam ID},",
						"          {CXR-CCI},",
						"          {CXI-CCR},",
						"          {CXI-CCI},",
						"          {XRExam Key} = select2@{Exam Key}",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> select3",
						"derivedColumn2, filter4 join({Exam Key} == {XRExam Key},",
						"     joinType:'left',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     broadcast: 'right')~> join2",
						"filter3 window(over({Exam Key} = {CTExam Key}),",
						"     asc({CTExam Key}, true),",
						"     asc({CXR-CCI}, true),",
						"     asc({CXI-CCR}, true),",
						"     asc({CXI-CCI}, true),",
						"     Rank = denseRank()) ~> window1",
						"window1 filter(Rank==1) ~> filter4",
						"filter4 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     recreate:true,",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> sink1",
						"join2 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          {CRIS No} as integer,",
						"          {Event Key} as integer,",
						"          {Exam Key} as integer,",
						"          {Trust ID} as integer,",
						"          {Exam Room ID} as integer,",
						"          {Event Date} as date,",
						"          {Date First Verified} as timestamp,",
						"          {Reported By} as string,",
						"          {Patient Type ID} as long,",
						"          {Age At Event} as string,",
						"          {Exam ID} as integer,",
						"          Auto as integer,",
						"          {Rep Rad} as integer,",
						"          Cons as integer,",
						"          Outsource as integer,",
						"          {CX I-R} as integer,",
						"          Snapshot as integer,",
						"          Abnormal as integer,",
						"          {CRIS No.1} as integer,",
						"          {Event Key.1} as integer,",
						"          {Exam Key.1} as integer,",
						"          {Trust ID.1} as integer,",
						"          {Exam Room ID.1} as integer,",
						"          {Event Date.1} as date,",
						"          {Date First Verified.1} as timestamp,",
						"          {Reported By.1} as string,",
						"          {Patient Type ID.1} as long,",
						"          {Age At Event.1} as string,",
						"          {Exam ID.1} as integer,",
						"          {CXR-CCI.1} as integer,",
						"          {CXI-CCR.1} as integer,",
						"          {CXI-CCI.1} as integer",
						"     ),",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     truncate:true,",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> sink3"
					]
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/dataflow7')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "ODBC_PTL_v2",
								"type": "DatasetReference"
							},
							"name": "source1"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "Patient_Waiting",
								"type": "DatasetReference"
							},
							"name": "sink1"
						}
					],
					"transformations": [
						{
							"name": "select1"
						}
					],
					"scriptLines": [
						"source(output(",
						"          {Event Key} as integer,",
						"          {Exam Key} as integer,",
						"          {CRIS Number} as integer,",
						"          {Status Category} as string,",
						"          {Request Date} as timestamp,",
						"          {Event Date} as timestamp,",
						"          {Booked Date Time} as timestamp,",
						"          {Creation Date} as timestamp,",
						"          Attended as string,",
						"          Urg as integer,",
						"          {Days Waiting} as integer,",
						"          {Predicted Reset Date} as timestamp,",
						"          {Waiting Time Reset Date} as timestamp,",
						"          {Weeks Waiting} as integer,",
						"          {Planned Appointment Date} as timestamp,",
						"          {Waiting Breach Date} as timestamp,",
						"          {Was Planned} as string,",
						"          {Was Scheduled} as string,",
						"          {Was Waiting} as string,",
						"          {Stat Date} as date,",
						"          {5 Weeks Wait} as integer,",
						"          {Booked Datetime} as string,",
						"          {6 Weeks Wait} as string,",
						"          {Referral Source ID} as integer,",
						"          {Exam ID} as integer,",
						"          {Modality ID} as integer,",
						"          {Exam Room ID} as integer,",
						"          {Trust ID} as integer,",
						"          {Status Code} as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> source1",
						"source1 select(mapColumn(",
						"          {Event Key},",
						"          {Exam Key},",
						"          {Exam ID},",
						"          {Exam Room ID},",
						"          {Request Date},",
						"          {Planned Appointment Date},",
						"          {Waiting Time Reset Date},",
						"          {Event Date},",
						"          {Weeks Waiting},",
						"          {Modality ID},",
						"          {Was Planned},",
						"          {Was Scheduled},",
						"          {Was Waiting},",
						"          {Referral Source ID},",
						"          {Trust ID},",
						"          {Status Code},",
						"          {Stat Date}",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> select1",
						"select1 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     recreate:true,",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> sink1"
					]
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/dataflow8 backlog')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "DelimitedText1",
								"type": "DatasetReference"
							},
							"name": "source1"
						},
						{
							"dataset": {
								"referenceName": "Exam",
								"type": "DatasetReference"
							},
							"name": "source2"
						},
						{
							"dataset": {
								"referenceName": "Modality",
								"type": "DatasetReference"
							},
							"name": "source3"
						},
						{
							"dataset": {
								"referenceName": "Referral_Source",
								"type": "DatasetReference"
							},
							"name": "source4"
						},
						{
							"dataset": {
								"referenceName": "Trust",
								"type": "DatasetReference"
							},
							"name": "source5"
						},
						{
							"dataset": {
								"referenceName": "Exam_Site",
								"type": "DatasetReference"
							},
							"name": "source6"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "Patient_Waiting_Monthly",
								"type": "DatasetReference"
							},
							"name": "sink1"
						}
					],
					"transformations": [
						{
							"name": "select1"
						},
						{
							"name": "lookup1"
						},
						{
							"name": "lookup2"
						},
						{
							"name": "lookup3"
						},
						{
							"name": "lookup4"
						},
						{
							"name": "lookup5"
						},
						{
							"name": "derivedColumn1"
						},
						{
							"name": "derivedColumn2"
						}
					],
					"scriptLines": [
						"source(output(",
						"          ImportDate as string,",
						"          {Event key} as string,",
						"          {Exam key} as string,",
						"          Examination as string,",
						"          {Exam Name} as string,",
						"          Site as string,",
						"          {Request date} as string,",
						"          {Planned App Date} as string,",
						"          {Clock Reset Date} as string,",
						"          {Event Date} as string,",
						"          Weeks as string,",
						"          Modality as string,",
						"          Planned as string,",
						"          {Referral Source Name} as string,",
						"          {Trust Name} as string,",
						"          {Status Cde} as string,",
						"          Room as string,",
						"          {Room Desc} as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     ignoreNoFilesFound: false) ~> source1",
						"source(output(",
						"          {Exam Name} as string,",
						"          {Exam Code} as string,",
						"          {Exam ID} as integer",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> source2",
						"source(output(",
						"          Modality2 as string,",
						"          {Modality ID} as integer",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> source3",
						"source(output(",
						"          {Referral Source} as string,",
						"          {Referral Source ID} as integer",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> source4",
						"source(output(",
						"          {Trust Name} as string,",
						"          {Trust ID} as integer,",
						"          {Trust Name Group} as string,",
						"          {Trust Name Group2} as string,",
						"          {Trust Name Group3} as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> source5",
						"source(output(",
						"          {Exam Site} as string,",
						"          {Exam Room} as string,",
						"          {Exam Site Code} as string,",
						"          {Exam Room ID} as integer",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> source6",
						"lookup5 select(mapColumn(",
						"          {Event Key} = {Event key},",
						"          {Exam Key} = {Exam key},",
						"          {Exam ID},",
						"          {Exam Room ID},",
						"          {Request Date} = {Request date},",
						"          {Planned Appointment Date} = {Planned App Date},",
						"          {Waiting Time Reset Date} = {Clock Reset Date},",
						"          {Event Date},",
						"          {Weeks Waiting} = Weeks,",
						"          {Modality ID},",
						"          {Was Planned} = Planned,",
						"          {Referral Source ID},",
						"          {Trust ID},",
						"          {Status Code} = {Status Cde},",
						"          {Stat Date} = ImportDate",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> select1",
						"source1, source2 lookup(Examination == {Exam Code},",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> lookup1",
						"derivedColumn1, source3 lookup(derivedColumn1@Modality2 == source3@Modality2,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> lookup2",
						"lookup2, source4 lookup({Referral Source Name} == {Referral Source},",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> lookup3",
						"lookup3, source5 lookup({Trust Name1} == source5@{Trust Name},",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> lookup4",
						"lookup4, source6 lookup(Site == {Exam Site}",
						"     && Room == {Exam Room},",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> lookup5",
						"lookup1 derive(Modality2 = iif(Modality==\"B\", \"Mammo\", \r",
						"iif(Modality==\"E\", \"Endo\", \r",
						"iif(Modality==\"H\", \"Cardio\", \r",
						"iif(Modality==\"R\", \"Plain X-Ray\",\r",
						"iif(Modality==\"Y\", \"Med Phys\", \r",
						"iif(Modality==\"Z\", \"Additional Workload\", \r",
						"iif(Modality==\"D\", \"Doppler\", \r",
						"iif(Modality==\"C\", \"CT\",\r",
						"iif(Modality==\"M\", \"MRI\",\r",
						"iif(Modality==\"U\", \"NOUS\", \r",
						"iif(Modality==\"N\", \"Nuc Med\",\r",
						"iif(Modality==\"S\", \"DEXA\", \r",
						"iif(Modality==\"O\", \"Obstetrics\", \r",
						"iif(Modality==\"A\", \"IR\", \r",
						"iif(Modality==\"F\", \"Fluoro\", \"Other\"))))))))))))))),",
						"          {Trust Name1} = iif({Trust Name}==\"ST HELENS AND KNOWSLEY HOSPITALS NHS TRUST\", \"STHK\", \r",
						"iif({Trust Name}==\"LIVERPOOL HEART & CHEST HOSPITAL NHS TRUST\", \"LHCH\", \r",
						"iif({Trust Name}==\"ALDER HEY CHILDREN'S NHS FOUNDATION TRUST\", \"Alder Hey\", \r",
						"iif({Trust Name}==\"THE MID CHESHIRE HOSPITALS NHS TRUST\", \"MCH\", \r",
						"iif({Trust Name}==\"THE CLATTERBRIDGE CANCER CENTRE NHS FOUNDATION TRUST\", \"CCC\", \r",
						"iif({Trust Name}==\"LIVERPOOL WOMEN'S NHS FOUNDATION TRUST\", \"Womens\", \r",
						"iif({Trust Name}==\"WALTON CENTRE NHS FOUNDATION TRUST\", \"TWC\", \r",
						"iif({Trust Name}==\"LIVERPOOL UNIVERSITY HOSPITALS NHS FOUNDATION TRUST\", \"LUHFT\", \r",
						"iif({Trust Name}==\"SOUTHPORT AND ORMSKIRK HOSPITAL NHS TRUST\", \"S&O\", \r",
						"iif({Trust Name}==\"WARRINGTON AND HALTON HOSPITALS NHS FOUNDATION TRUST\", \"WHH\", \"Other\"))))))))))) ~> derivedColumn1",
						"select1 derive({Request Date} = toDate({Request Date},\"dd/MM/yyyy\"),",
						"          {Planned Appointment Date} = toDate({Planned Appointment Date},\"dd/MM/yyyy\"),",
						"          {Waiting Time Reset Date} = toDate({Waiting Time Reset Date},\"dd/MM/yyyy\"),",
						"          {Event Date} = toDate({Event Date},\"dd/MM/yyyy\")) ~> derivedColumn2",
						"derivedColumn2 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     recreate:true,",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> sink1"
					]
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/dataflow8')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "ODBC_PTL_v2",
								"type": "DatasetReference"
							},
							"name": "source1"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "Patient_Waiting_Monthly",
								"type": "DatasetReference"
							},
							"name": "sink1"
						}
					],
					"transformations": [
						{
							"name": "select1"
						}
					],
					"scriptLines": [
						"source(output(",
						"          {Event Key} as integer,",
						"          {Exam Key} as integer,",
						"          {CRIS Number} as integer,",
						"          {Status Category} as string,",
						"          {Request Date} as timestamp,",
						"          {Event Date} as timestamp,",
						"          {Booked Date Time} as timestamp,",
						"          {Creation Date} as timestamp,",
						"          Attended as string,",
						"          Urg as integer,",
						"          {Days Waiting} as integer,",
						"          {Predicted Reset Date} as timestamp,",
						"          {Waiting Time Reset Date} as timestamp,",
						"          {Weeks Waiting} as integer,",
						"          {Planned Appointment Date} as timestamp,",
						"          {Waiting Breach Date} as timestamp,",
						"          {Was Planned} as string,",
						"          {Was Scheduled} as string,",
						"          {Was Waiting} as string,",
						"          {Stat Date} as date,",
						"          {5 Weeks Wait} as integer,",
						"          {Booked Datetime} as string,",
						"          {6 Weeks Wait} as string,",
						"          {Referral Source ID} as integer,",
						"          {Exam ID} as integer,",
						"          {Modality ID} as integer,",
						"          {Exam Room ID} as integer,",
						"          {Trust ID} as integer,",
						"          {Status Code} as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table') ~> source1",
						"source1 select(mapColumn(",
						"          {Event Key},",
						"          {Exam Key},",
						"          {Exam ID},",
						"          {Exam Room ID},",
						"          {Request Date},",
						"          {Planned Appointment Date},",
						"          {Waiting Time Reset Date},",
						"          {Event Date},",
						"          {Weeks Waiting},",
						"          {Modality ID},",
						"          {Was Planned},",
						"          {Was Scheduled},",
						"          {Was Waiting},",
						"          {Referral Source ID},",
						"          {Trust ID},",
						"          {Status Code},",
						"          {Stat Date}",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> select1",
						"select1 sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     format: 'table',",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     errorHandlingOption: 'stopOnFirstError') ~> sink1"
					]
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Ingestion_RADFYF')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy_CORE",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"queryTimeout": "24:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table [dev].[FYF_ODBC_CORE]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "CRIS No",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "CRIS No",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Accession",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Accession",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Ref Src",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Ref Src",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Referring Locat",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Referring Locat",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Referrer",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Referrer",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Speciality",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Speciality",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "GP",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "GP",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Practice",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Practice",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Site",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Site",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Request Date",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "Request Date",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "Event Date",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "Event Date",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "Event Time",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Event Time",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "On Call",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "On Call",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "PT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PT",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "RC",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RC",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Examination",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Examination",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Exam Name",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Exam Name",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Room",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Room",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Start Time",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Start Time",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "End Time",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "End Time",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Radiographer 1",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Radiographer 1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Radiographer 2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Radiographer 2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Required Clinician",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Required Clinician",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Contrast Code",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Contrast Code",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Qty Used",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 6
										},
										"sink": {
											"name": "Qty Used",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 6
										}
									},
									{
										"source": {
											"name": "Exam Key",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "Exam Key",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Event Key",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "Event Key",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Status Code",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Status Code",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Booked Date",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "Booked Date",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "Booked Time",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Booked Time",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Creation Date",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "Creation Date",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "Attended",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Attended",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Event Key2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "Event Key2",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Lead Clinician",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Lead Clinician",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Intended Radiologist",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Intended Radiologist",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Urg",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Urg",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Referring Locat Name ",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Referring Locat Name ",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Referrer Name",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Referrer Name",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Modality",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Modality",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "No of Proc",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "No of Proc",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "GP Name",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "GP Name",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Planned Appointment Date",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "Planned Appointment Date",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "Date First Verified",
											"type": "DateTime",
											"physicalType": "datetime2"
										},
										"sink": {
											"name": "Date First Verified",
											"type": "DateTime",
											"physicalType": "datetime2"
										}
									},
									{
										"source": {
											"name": "Reported By",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Reported By",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Reported By2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Reported By2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Reported By2 Name",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Reported By2 Name",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Reported By Name",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Reported By Name",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Time First Verified",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Time First Verified",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Time Taken",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "Time Taken",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Typed By",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Typed By",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Was Planned",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Was Planned",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Was Scheduled",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Was Scheduled",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Was Waiting",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Was Waiting",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "CCG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "CCG",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Day of Week",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Day of Week",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Stat Date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Stat Date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SqlServer_CORE",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "AzureSql_CORE",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Copy_ORDERS",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy_CORE",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"queryTimeout": "24:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table [dev].[FYF_ODBC_ORDERS]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "CRIS No",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "CRIS No",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Exam Key",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "Exam Key",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Order Key",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "Order Key",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Creation Date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Creation Date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "Ref Src",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Ref Src",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Referrer",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Referrer",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Lead Clinician",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Lead Clinician",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Required Date",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Required Date",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Required Time",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Required Time",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Order Id",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Order Id",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Order Source",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Order Source",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Episode No",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Episode No",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Order Type",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Order Type",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Examination",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Examination",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Urg",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Urg",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Stat Date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Stat Date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SqlServer_ORDERS",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "AzureSql_ORDERS",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Copy_REQUESTS",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy_ORDERS",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"queryTimeout": "24:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table [dev].[FYF_ODBC_REQUESTS]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Accession",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Accession",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Exam Key",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "Exam Key",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Event Key",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "Event Key",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Urg",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Urg",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Ref Src",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Ref Src",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Referring Locat",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Referring Locat",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Referrer",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Referrer",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Lead Clinician",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Lead Clinician",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Site",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Site",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Request Date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Request Date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "Event Date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Event Date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "Event Time",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Event Time",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "On Call",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "On Call",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "PT",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "PT",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "RC",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RC",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Examination",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Examination",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Examination Name",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Examination Name",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Required Clinician",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Required Clinician",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Status Code",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Status Code",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Booked Date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Booked Date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "Booked Time",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Booked Time",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Event Key2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "Event Key2",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Creation Date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Creation Date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "Attended",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Attended",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Referrer Name",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Referrer Name",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Modality",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Modality",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Event Date at Date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Event Date at Date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "Predicted Reset Date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Predicted Reset Date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "Waiting Time Reset Date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Waiting Time Reset Date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "Planned Appointment Date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Planned Appointment Date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "Waiting Time Breach Date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Waiting Time Breach Date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "Stat Date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Stat Date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SqlServer_REQUESTS",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "AzureSql_REQUESTS",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Copy_STATUSES",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy_REQUESTS",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"queryTimeout": "24:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table [dev].[FYF_ODBC_STATUSES]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Exam Key",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "Exam Key",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Event Key",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "Event Key",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Accession",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Accession",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Referrer",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Referrer",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Referral Location",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Referral Location",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Referral Source",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Referral Source",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Urg",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Urg",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Site",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Site",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Status Code",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Status Code",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Status Date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Status Date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "Status Time",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "Status Time",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Referral Location Name",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Referral Location Name",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Referral Source Name",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Referral Source Name",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Referral Name",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Referral Name",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Examination Name",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Examination Name",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Modality",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Modality",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Status Code at State Date",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Status Code at State Date",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Stat Date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Stat Date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "D Status",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "D Status",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SqlServer_STATUSES",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "AzureSql_STATUSES",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Copy_APDNA",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Lastest status",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"queryTimeout": "24:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table [dev].[FYF_ODBC_APDNA]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Event Key",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "Event Key",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Accession",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Accession",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Event Date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Event Date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "Booked Date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Booked Date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "Referring Locat",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Referring Locat",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Examination",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Examination",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Room",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Room",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Status Code",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Status Code",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Lead Clincian ",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Lead Clincian ",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Examination Name",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Examination Name",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Stat Date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Stat Date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SqlServer_APDNA",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "AzureSql_APDNA",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Copy_Imports",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy_APDNA",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"queryTimeout": "24:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table [dev].[FYF_ODBC_IMPORTS]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Site",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Site",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Room",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Room",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Room Description",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Room Description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Stat Date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Stat Date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SqlServerTable1",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Azure_Imports",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Copy_LUNGCa",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy_Imports",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"queryTimeout": "24:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table [dev].[FYF_ODBC_LUNG_Ca_ALERTS]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Event key",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "Event key",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Exam key",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "Exam key",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Site",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Site",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Event Date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Event Date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "Examination",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Examination",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Date Verified",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Date Verified",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "Date Last Verified",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Date Last Verified",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "Reported by",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Reported by",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Referral Source",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Referral Source",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Referring Location",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Referring Location",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Date Reported",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Date Reported",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "Stat Date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Stat Date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SqlServer_LUNGCA",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "AzureSql_LUNGCa",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Copy_PATIENTS",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy_LUNGCa",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"queryTimeout": "24:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "Truncate table [dev].[FYF_ODBC_PATIENTS]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "CRIS No",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "CRIS No",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Creation Date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Creation Date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "Mutation Date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Mutation Date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "Event Date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Event Date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "DOD",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "DOD",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "Ethnic Origin",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Ethnic Origin",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "GP",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "GP",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "No of Attends",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "No of Attends",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "No of Events",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "No of Events",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Ref Src",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Ref Src",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Referrer Name",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Referrer Name",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Age at Event",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "Age at Event",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "HIS ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "HIS ID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "CCG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "CCG",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Stat Date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Stat Date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SqlServer_PATIENTS",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "AzureSql_Patients",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Copy_PTL",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy_PATIENTS",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"queryTimeout": "24:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table [dev].[FYF_ODBC_PTL]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Event Key",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "Event Key",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Exam Key",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "Exam Key",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "CRIS Number",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "CRIS Number",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Status Category",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Status Category",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Referrer",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Referrer",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Ref Src",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Ref Src",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Referring Location",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Referring Location",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Examination",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Examination",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Site",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Site",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Request Date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Request Date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "Event Date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Event Date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "Booked Time",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Booked Time",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Booked Date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Booked Date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "Ref Src2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Ref Src2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Creation Date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Creation Date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "Event Key2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "Event Key2",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Attended",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Attended",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Modality",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Modality",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Room",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Room",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "RC",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RC",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Urg",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "Urg",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Referrer Name",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Referrer Name",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Exam Name",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Exam Name",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Event Date2",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Event Date2",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "Days Waiting",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "Days Waiting",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Predicted Reset Date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Predicted Reset Date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "Waiting Time Reset Date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Waiting Time Reset Date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "Weeks Waiting",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "Weeks Waiting",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Planned Appointment Date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Planned Appointment Date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "Waiting Breach Date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Waiting Breach Date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "Was Planned",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Was Planned",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Was Scheduled",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Was Scheduled",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Was Waiting",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Was Waiting",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "CCG",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "CCG",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "D Status",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "D Status",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Stat Date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Stat Date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SqlServer_PTL",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "AzureSql_PTL",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Copy_REPORT_TAT",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy_PTL",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"queryTimeout": "24:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table [dev].[FYF_ODBC_REPORTING_TAT]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Accession",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Accession",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Event Key",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "Event Key",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Exam Key",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "Exam Key",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Report Key",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "Report Key",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Request Date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Request Date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "Event Date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Event Date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "Event Time",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Event Time",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Lead Clinician",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Lead Clinician",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Referrer",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Referrer",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Referring Locat",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Referring Locat",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Site",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Site",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Examination",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Examination",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Exam Name",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Exam Name",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Event Key2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "Event Key2",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Status Code",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Status Code",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Intended Radiologist",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Intended Radiologist",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Ref Src",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Ref Src",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Modality",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Modality",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Date First Addended",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Date First Addended",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "Date First Verified",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Date First Verified",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "Date Last Addended",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Date Last Addended",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "Date LAst Verified",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Date LAst Verified",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "Date Reported",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Date Reported",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "Date Typed",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Date Typed",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "First Addended By",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "First Addended By",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "First Addended by Name",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "First Addended by Name",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "First Verified By",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "First Verified By",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "First Verified By Name",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "First Verified By Name",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Last Addended By",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Last Addended By",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Last Addended By Name",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Last Addended By Name",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Last Verified By",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Last Verified By",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Last Verified By Name",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Last Verified By Name",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Reported By",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Reported By",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Reported By2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Reported By2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Reported By Name",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Reported By Name",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Reported By2 Name",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Reported By2 Name",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "First Verified Time",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "First Verified Time",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Last Verified Time",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Last Verified Time",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Time Reported",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Time Reported",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Time Typed",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Time Typed",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Typed By",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Typed By",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Attend to First Verified Days",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "Attend to First Verified Days",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Attend to Reported Days",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "Attend to Reported Days",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Stat Date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Stat Date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SqlServer_REPO_TAT",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "AzureSql_REPORT_TAT",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Copy_REPORT_META",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy_REPORT_TAT",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"queryTimeout": "24:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table [dev].[FYF_ODBC_REPORT_META]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Event Key",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "Event Key",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Report Key",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "Report Key",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Exam Key",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "Exam Key",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Event Key2",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "Event Key2",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Referral Source",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Referral Source",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Event Date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Event Date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "Event Time",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Event Time",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Date of First Addendnum",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Date of First Addendnum",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "Date First Verified",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Date First Verified",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "Date of Last Addendnum",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Date of Last Addendnum",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "Date Last Verified",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Date Last Verified",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "Date Reported",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Date Reported",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "Date Typed",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Date Typed",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "Reported by",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Reported by",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Reported by2",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Reported by2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Reported by2 Name",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Reported by2 Name",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Reported by Name",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Reported by Name",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Typed by",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Typed by",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Typed by Name",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Typed by Name",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Stat Date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Stat Date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SqlServer_REPO_META",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "AzureSql_REPORT_META",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Copy_TEST_PATIENTS",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Copy_REPORT_META",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"queryTimeout": "24:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table [dev].[FYF_ODBC_TEST_Patients]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "CRIS No",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "CRIS No",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Creation Date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Creation Date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "Mutation Date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Mutation Date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "Surname",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Surname",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Forename",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Forename",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Stat Date",
											"type": "DateTime",
											"physicalType": "datetime"
										},
										"sink": {
											"name": "Stat Date",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SqlServer_TEST_PAT",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "AzureSql_TEST_PATIENTS",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Add Columns Core",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "Copy_TEST_PATIENTS",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "dataflow1",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"AzureSqlCORE": {},
									"source1": {},
									"AzureSqlCOREStageStep1": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "AutoResolveAzureIR",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "CreateReferrenceTables",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "PopulateNewColumns",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "dataflow2",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"AzureSqlCOREV3Staging": {},
									"AzureSqlPTL": {},
									"TatType": {},
									"Trust": {},
									"sink4": {},
									"Modality": {},
									"Status": {},
									"Exam": {},
									"PatientType": {},
									"ReferralSource": {}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "ReferenceLookupsCore",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "CreateReferrenceTables",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "dataflow3",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"AzureSQLCoreV3Staging": {},
									"PatientType": {},
									"Modality": {},
									"Status": {},
									"Exam": {},
									"ExamSite": {},
									"Trust": {},
									"ReferralSource": {},
									"TatType": {},
									"AzureSqlCOREV2": {}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "ReferenceLookupsPTL",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "ReferenceLookupsCore",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "dataflow1_copy1",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"AzureSqlPTL": {},
									"ReferralSource": {},
									"Exam": {},
									"Trust": {},
									"Modality": {},
									"ExamSite": {},
									"source1": {},
									"source2": {},
									"AzureSqlPTLV2Staging": {}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "CreateAct_Dem",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "ReferenceLookupsPTL",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "CreateActDem",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"Core": {},
									"sink1": {}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "Lastest status",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "Copy_STATUSES",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "dataflow4",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"source1": {},
									"sink1": {}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "PopulateNewColumns",
						"type": "ExecuteWranglingDataflow",
						"dependsOn": [
							{
								"activity": "Add Columns Core",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "PopulateNewColumns",
								"type": "DataFlowReference",
								"datasetParameters": {
									"RequestRecievedStatus": {},
									"AzureSqlCOREStageStep1": {},
									"UserQueryAzureSqlCOREStageStep2": {}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"queries": [
								{
									"queryName": "UserQuery",
									"dataflowSinks": [
										{
											"name": "UserQueryAzureSqlCOREStageStep2",
											"dataset": {
												"referenceName": "AzureSqlCOREStageStep2",
												"type": "DatasetReference",
												"parameters": {}
											},
											"script": "sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tinput(\n\t\t{CRIS No} as integer,\n\t\tAccession as string,\n\t\t{Ref Src} as string,\n\t\tSite as string,\n\t\t{Request Date} as date,\n\t\t{Event Date} as date,\n\t\t{Event Time} as string,\n\t\t{On Call} as string,\n\t\tPT as string,\n\t\tExamination as string,\n\t\t{Exam Name} as string,\n\t\tRoom as string,\n\t\t{Start Time} as string,\n\t\t{End Time} as string,\n\t\t{Exam Key} as integer,\n\t\t{Event Key} as integer,\n\t\t{Status Code} as string,\n\t\t{Booked Date} as timestamp,\n\t\t{Booked Time} as string,\n\t\t{Creation Date} as timestamp,\n\t\tAttended as string,\n\t\tUrg as string,\n\t\tModality as string,\n\t\t{No of Proc} as integer,\n\t\t{Planned Appointment Date} as timestamp,\n\t\t{Date First Verified} as timestamp,\n\t\t{Time First Verified} as string,\n\t\t{Was Planned} as string,\n\t\t{Was Scheduled} as string,\n\t\t{Was Waiting} as string,\n\t\t{Stat Date} as timestamp,\n\t\t{Reported By} as string,\n\t\tRank as integer,\n\t\t{Age At Event} as string,\n\t\t{Status Code.2} as string,\n\t\t{Status Date.1} as timestamp,\n\t\t{Status Time} as string,\n\t\tModality2 as string,\n\t\t{Trust Name} as string,\n\t\tPatient_Type as string,\n\t\t{Tat Type} as string,\n\t\t{Activity.1} as integer,\n\t\t{Count of Activty_Demand for Activity.1} as long,\n\t\t{ExamSite Code} as string\n\t),\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\ttruncate:true,\n\tformat: 'table',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError') ~> UserQueryAzureSqlCOREStageStep2"
										}
									]
								}
							]
						}
					},
					{
						"name": "Data flow1",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "Data flow2",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "dataflow6",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"source1": {},
									"sink1": {},
									"sink3": {}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "Data flow2",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "CreateAct_Dem",
								"dependencyConditions": [
									"Completed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "dataflow7",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"source1": {},
									"sink1": {}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"folder": {
					"name": "RADFYF"
				},
				"annotations": [],
				"lastPublishTime": "2024-01-30T12:35:07Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/dataflows/dataflow1')]",
				"[concat(variables('factoryId'), '/dataflows/dataflow2')]",
				"[concat(variables('factoryId'), '/dataflows/dataflow3')]",
				"[concat(variables('factoryId'), '/dataflows/dataflow1_copy1')]",
				"[concat(variables('factoryId'), '/dataflows/CreateActDem')]",
				"[concat(variables('factoryId'), '/dataflows/dataflow4')]",
				"[concat(variables('factoryId'), '/dataflows/PopulateNewColumns')]",
				"[concat(variables('factoryId'), '/dataflows/dataflow6')]",
				"[concat(variables('factoryId'), '/dataflows/dataflow7')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Monthly')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Data flow2",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "dataflow8",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"source1": {},
									"sink1": {}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {}
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/dataflows/dataflow8')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/trig_DM01_Weekly')]",
			"type": "Microsoft.DataFactory/factories/triggers",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"runtimeState": "Started",
				"pipelines": [
					{
						"pipelineReference": {
							"referenceName": "Move from ICB to CAMRIN",
							"type": "PipelineReference"
						},
						"parameters": {}
					}
				],
				"type": "ScheduleTrigger",
				"typeProperties": {
					"recurrence": {
						"frequency": "Week",
						"interval": 1,
						"startTime": "2023-11-23T11:22:00",
						"timeZone": "GMT Standard Time",
						"schedule": {
							"minutes": [
								0
							],
							"hours": [
								23
							],
							"weekDays": [
								"Sunday"
							]
						}
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/pipelines/Move from ICB to CAMRIN')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Daily')]",
			"type": "Microsoft.DataFactory/factories/triggers",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"runtimeState": "Started",
				"pipelines": [
					{
						"pipelineReference": {
							"referenceName": "Ingestion_RADFYF",
							"type": "PipelineReference"
						},
						"parameters": {}
					}
				],
				"type": "ScheduleTrigger",
				"typeProperties": {
					"recurrence": {
						"frequency": "Day",
						"interval": 1,
						"startTime": "2023-08-09T08:00:00",
						"timeZone": "GMT Standard Time",
						"schedule": {
							"minutes": [
								0
							],
							"hours": [
								1
							]
						}
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/pipelines/Ingestion_RADFYF')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Initial Bulk Upload')]",
			"type": "Microsoft.DataFactory/factories/triggers",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"runtimeState": "Started",
				"pipelines": [
					{
						"pipelineReference": {
							"referenceName": "Ingestion_RADFYF",
							"type": "PipelineReference"
						},
						"parameters": {}
					}
				],
				"type": "ScheduleTrigger",
				"typeProperties": {
					"recurrence": {
						"frequency": "Day",
						"interval": 1,
						"startTime": "2023-02-01T15:11:00",
						"endTime": "2023-02-03T15:11:00",
						"timeZone": "GMT Standard Time",
						"schedule": {
							"minutes": [
								0
							],
							"hours": [
								2
							]
						}
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/pipelines/Ingestion_RADFYF')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Monthly')]",
			"type": "Microsoft.DataFactory/factories/triggers",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"runtimeState": "Stopped",
				"pipelines": [
					{
						"pipelineReference": {
							"referenceName": "Monthly",
							"type": "PipelineReference"
						},
						"parameters": {}
					}
				],
				"type": "ScheduleTrigger",
				"typeProperties": {
					"recurrence": {
						"frequency": "Month",
						"interval": 1,
						"startTime": "2024-04-01T03:30:00",
						"timeZone": "GMT Standard Time",
						"schedule": {
							"minutes": [
								30
							],
							"hours": [
								3
							],
							"monthDays": [
								1
							]
						}
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/pipelines/Monthly')]"
			]
		}
	]
}